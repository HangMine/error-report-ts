{"version":3,"sources":["webpack:///./src/utils/oss/uploadToOSS.js","webpack:///./src/mixins/form-validation.js","webpack:///./node_modules/core-js/modules/es.string.repeat.js","webpack:///./src/views/order-meeting/Upload/index.vue?e20f","webpack:///src/views/order-meeting/Upload/index.vue","webpack:///./src/views/order-meeting/Upload/index.vue?c484","webpack:///./src/views/order-meeting/Upload/index.vue","webpack:///./src/components/form/InputWithUnit.vue?a260","webpack:///./src/components/form/InputWithUnit.vue?7238","webpack:///src/components/form/InputWithUnit.vue","webpack:///./src/components/form/InputWithUnit.vue?1421","webpack:///./src/components/form/InputWithUnit.vue","webpack:///./src/mixins/loading.js","webpack:///./node_modules/core-js/modules/es.number.is-nan.js","webpack:///./src/components/collapse/Collapse.vue?a1d2","webpack:///./src/components/collapse/Collapse.vue","webpack:///src/components/collapse/Collapse.vue","webpack:///./src/components/collapse/Collapse.vue?2a37","webpack:///./src/views/order-meeting/Upload/index.vue?0c71"],"names":["uploadToOSS","blobOrDataUrl","sourceType","onUpload","body","isDataUrl","dataUrl2Blob","OSSUploader","send","key","mixinValidateForm","methods","validateForm","Object","keys","form","forEach","prop","trim","replace","validateFormFields","$refs","$emit","console","warn","Error","i18n","t","resetFields","this","mixinValidateFormField","validateFormField","field","value","validate","valid","invalidFields","mixinCheckPasswordAsPrevious","data","validatePasswordConfirm","rule","callback","pass","passwordConfirm","rules","validator","requirement","charLengthMini","handlePasswordChange","validateField","$","repeat","target","proto","render","_vm","_h","$createElement","_c","_self","ref","staticClass","_v","attrs","on","v","barCode","model","$$v","$set","expression","staticStyle","price","monetaryUnit","label","$i18n","i18next","language","$event","size","split","tags","join","e","$act","pickThumb","files","length","cover","curtailImgUrl","pick4ds","_s","name","shoeInfoExtraField","add","batchPickSku","_l","item","i","_id","frameUploadedSize","thumbUploadedSize","color","percentages","thumbFiles","frameFiles","isUploading","uploadSku","modelNumber","clearSkuFiles","pickSku","upSku","skuList","downSku","deleteItem","submit","staticRenderFns","arrFiles2MapFiles","mapFiles","basePath","path","startsWith","slice","components","CustomCollapse","InputWithUnit","VueInputTag","BaseImage","props","workspaceId","default","mixins","curtailImgFile","undefined","parentFolderId","appType","season","series","materials","width","weight","dimensions","inspiration","skuLules","collocationName","created","watch","oldUrl","URL","revokeObjectURL","computed","createObjectURL","map","s","parseInt","styleNameReadonly","reduce","memo","file","ext","createSku","Date","now","thumbLength","useThumbJPG","threeDimensional","push","sku","splice","getSkuByName","find","_refreshPage","component","inputPlaceholder","disabled","nativeOn","handleChangeUnitNumber","text","withoutSelect","_e","selectedUnit","type","Boolean","String","Number","defaultUnit","unitOptions","Array","required","decimalPlaces","integerPlaces","threshold","mounted","changeUnitNumber","parseFloat","isNaN","includes","$message","warning","temp","isDecimal","_handleDecimalNumber","number","int","_addNumberSeparator","toLocaleString","loadingVeil","startLoading","Loading","service","lock","background","endLoading","close","stat","functional","title","styles","divider","closed"],"mappings":"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","file":"js/chunk-46510de8.4c6f7536.js","sourcesContent":["import { OSSUploader } from '@/utils/oss/uploader';\nimport isDataUrl from '_/is-data-url';\nimport { dataUrl2Blob } from '_/blob-utils';\n\n/**\n *\n * @param {Blob|string} blobOrDataUrl 一个dataUrl或者Blob对象（包括File）\n * @param {string} [sourceType] 资源类型 - @see {@link http://api.4dshoetech.com/project/61/interface/api/4387}\n * @param {(event: unknown,\n    fileLoaded: number,\n    fileSize: number,\n    process: number,\n    options: ComputedUploaderOptions<Params, Query>\n  ) => any} [onUpload] 上传进度 - 具体自己看结果或者源码\n * @return {Promise<string>}\n */\nconst uploadToOSS = async (blobOrDataUrl, sourceType, onUpload) => {\n  let body;\n  if (typeof blobOrDataUrl === 'string' && isDataUrl(blobOrDataUrl)) {\n    // 转化blob对象\n    body = dataUrl2Blob(blobOrDataUrl);\n  } else {\n    body = blobOrDataUrl;\n  }\n  // OSSUploader 会自动处理后缀名的问题，不需要额外的处理\n  // 上传到oss\n  /** @see {@link vscode://../from/a} */\n  const { key } = await OSSUploader.send({\n    sourceType,\n    body,\n    onUpload,\n  });\n\n  return key;\n};\n\nexport default uploadToOSS;\n","import i18n from 'i18next';\nimport validator, { validateFormFields } from '@/utils/validators/rules-validation';\n\n// 校验表单是否通过校验\nexport const mixinValidateForm = {\n  methods: {\n    async validateForm() {\n      Object.keys(this.form).forEach((prop) => {\n        if (typeof this.form[prop] === 'string') {\n          // 去掉首尾空格\n          // 防止XSS攻击（html方面）\n          this.form[prop] = this.form[prop]\n            .trim()\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;');\n        }\n      });\n\n      try {\n        await validateFormFields(this.$refs.form);\n        this.$emit('validate', this.form);\n        return this.form;\n      } catch (err) {\n        console.warn(err);\n        throw new Error(i18n.t('validator.form_val_fail'));\n      }\n    },\n    resetFields() {\n      this.$refs.form.resetFields();\n    },\n  },\n};\n\n// 校验表单中特定的field有没有通过校验；校验成功，返回其值\nexport const mixinValidateFormField = {\n  methods: {\n    validateFormField(field, value) {\n      this.$refs.form.validate((valid, invalidFields) => {\n        // 判断该属性是否在校验失败的field对象里面，如果校验通过则通知父组件\n        if (!invalidFields[field]) this.$emit('validate-field', { field, value });\n      });\n    },\n  },\n};\n\n// 校验再次输入的密码是否与上一次相同\nexport const mixinCheckPasswordAsPrevious = {\n  data() {\n    const validatePasswordConfirm = (rule, value, callback) => {\n      if (value !== this.form.pass) {\n        return callback(new Error(i18n.t('validator.same_as_prev')));\n      }\n      return callback();\n    };\n\n    return {\n      form: {\n        pass: '',\n        passwordConfirm: '',\n      },\n      rules: {\n        passwordConfirm: [\n          validator.requirement(),\n          validator.charLengthMini(6, 20),\n          { validator: validatePasswordConfirm },\n        ],\n      },\n    };\n  },\n  methods: {\n    // 当密码框输入变化时，要校验密码确认内容\n    // （此监听方法需添加到 password 上）\n    handlePasswordChange() {\n      if (this.form.passwordConfirm) this.$refs.form.validateField('passwordConfirm');\n    },\n  },\n};\n","var $ = require('../internals/export');\nvar repeat = require('../internals/string-repeat');\n\n// `String.prototype.repeat` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\n$({ target: 'String', proto: true }, {\n  repeat: repeat\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"orderMeetingUpload\",staticClass:\"upload-model-info\"},[_c('h1',{staticClass:\"section-title\"},[_vm._v(\"基本信息\")]),_c('el-form',{ref:\"form\",staticClass:\"custom-form clearfix\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules}},[_c('el-form-item',{attrs:{\"prop\":\"modelNumber\",\"label\":\"形体名\"}},[_c('el-input',{on:{\"change\":function (v) { return _vm.form.barCode = _vm.form.barCode || v; }},model:{value:(_vm.form.modelNumber),callback:function ($$v) {_vm.$set(_vm.form, \"modelNumber\", $$v)},expression:\"form.modelNumber\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"barCode\",\"label\":\"编码\"}},[_c('el-input',{model:{value:(_vm.form.barCode),callback:function ($$v) {_vm.$set(_vm.form, \"barCode\", $$v)},expression:\"form.barCode\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"season\",\"label\":\"季度\"}},[_c('el-input',{model:{value:(_vm.form.season),callback:function ($$v) {_vm.$set(_vm.form, \"season\", $$v)},expression:\"form.season\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"series\",\"label\":\"系列\"}},[_c('el-input',{model:{value:(_vm.form.series),callback:function ($$v) {_vm.$set(_vm.form, \"series\", $$v)},expression:\"form.series\"}})],1),_c('el-form-item',{staticStyle:{\"height\":\"80px\"},attrs:{\"prop\":\"price\",\"label\":\"单价\"}},[_c('input-with-unit',{attrs:{\"value\":_vm.form.price,\"default-unit\":_vm.form.monetaryUnit,\"unit-options\":[\n            { value: 'USD', label: _vm.$i18n.i18next.language === 'en' ? 'USD' : '美元' },\n            { value: 'CNY', label: _vm.$i18n.i18next.language === 'en' ? 'CNY' : '人民币' }\n          ],\"input-placeholder\":\"\",\"threshold\":2000},on:{\"on-input-blur\":function($event){_vm.form.price = $event},\"on-select-change\":function($event){_vm.form.monetaryUnit = $event}}})],1),_c('el-form-item',{attrs:{\"prop\":\"size\",\"label\":\"尺码（输入后请回车）\"}},[_c('vue-input-tag',{attrs:{\"value\":_vm.form.size === '' ? [] :  _vm.form.size.split(',')},on:{\"input\":function (tags) { return _vm.form.size = tags.join(','); }}})],1),_c('custom-collapse',{staticClass:\"width-100 clearfix\",attrs:{\"title\":\"其他信息\",\"colsed\":\"\"}},[_c('el-form-item',{staticStyle:{\"padding-right\":\"60px\",\"width\":\"25%\"},attrs:{\"prop\":\"shoeInfoExtraField.materials\",\"label\":\"缩略图\"}},[_c('row',[_c('label',{staticClass:\"upload-thumb\"},[_c('input',{attrs:{\"type\":\"file\",\"hidden\":\"\"},on:{\"change\":function (e) {\n              _vm.$act(_vm.pickThumb, [e.target.files[e.target.files.length - 1]]);\n              e.target.value = null\n            }}}),_c('BaseImage',{staticStyle:{\"width\":\"173px\",\"height\":\"130px\"},attrs:{\"fit\":_vm.cover,\"src\":_vm.curtailImgUrl}})],1)])],1),_c('el-form-item',{staticStyle:{\"padding-right\":\"60px\",\"width\":\"25%\"},attrs:{\"prop\":\"shoeInfoExtraField.materials\",\"label\":\"4ds\"}},[_c('row',[_c('label',{staticClass:\"upload-thumb\"},[_c('input',{attrs:{\"type\":\"file\",\"hidden\":\"\",\"accept\":\".4ds\"},on:{\"change\":function (e) {\n              _vm.$act(_vm.pick4ds, [e.target.files[0]]);\n              e.target.value = null\n            }}}),_c('div',{staticClass:\"file-icon\"},[(_vm.form['4dsFile'])?[_c('i',{staticClass:\"iconfont iconliebiao\"}),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.form['4dsFile'].name))])]:_c('i',{staticClass:\"iconfont icon-add\"})],2)])])],1),_c('el-form-item',{attrs:{\"prop\":\"shoeInfoExtraField.inspiration\",\"label\":\"描述\"}},[_c('div',{staticStyle:{\"height\":\"134px\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":6},model:{value:(_vm.form.shoeInfoExtraField.inspiration),callback:function ($$v) {_vm.$set(_vm.form.shoeInfoExtraField, \"inspiration\", $$v)},expression:\"form.shoeInfoExtraField.inspiration\"}})],1)]),_c('el-form-item',{attrs:{\"prop\":\"thumbFiles\",\"label\":\"面料\"}},[_c('el-input',{model:{value:(_vm.form.shoeInfoExtraField.materials),callback:function ($$v) {_vm.$set(_vm.form.shoeInfoExtraField, \"materials\", $$v)},expression:\"form.shoeInfoExtraField.materials\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"shoeInfoExtraField.width\",\"label\":\"宽度\"}},[_c('el-input',{model:{value:(_vm.form.shoeInfoExtraField.width),callback:function ($$v) {_vm.$set(_vm.form.shoeInfoExtraField, \"width\", $$v)},expression:\"form.shoeInfoExtraField.width\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"shoeInfoExtraField.weight\",\"label\":\"重量\"}},[_c('el-input',{model:{value:(_vm.form.shoeInfoExtraField.weight),callback:function ($$v) {_vm.$set(_vm.form.shoeInfoExtraField, \"weight\", $$v)},expression:\"form.shoeInfoExtraField.weight\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"shoeInfoExtraField.dimensions\",\"label\":\"边界尺寸\"}},[_c('el-input',{model:{value:(_vm.form.shoeInfoExtraField.dimensions),callback:function ($$v) {_vm.$set(_vm.form.shoeInfoExtraField, \"dimensions\", $$v)},expression:\"form.shoeInfoExtraField.dimensions\"}})],1)],1)],1),_c('custom-collapse',{staticClass:\"width-100 clearfix\",attrs:{\"title\":\"SKU\"}},[_c('div',{staticClass:\"text-align-right\",staticStyle:{\"margin-bottom\":\"10px\"}},[_c('el-button',{attrs:{\"type\":\"success\"},on:{\"click\":function($event){return _vm.add()}}},[_vm._v(\"添加\")]),_c('label',{staticClass:\"el-button el-button--primary\"},[_c('span',[_vm._v(\"批量添加sku以及文件\")]),_c('input',{attrs:{\"type\":\"file\",\"webkitdirectory\":\"\",\"multiple\":\"\"},on:{\"change\":function (e) {\n            _vm.$act(_vm.batchPickSku, [e.target.files]);\n            e.target.value = null\n          }}})])],1),_c('el-form',{staticClass:\"sku-form clearfix\",attrs:{\"label-width\":\"5em\"}},[_c('transition-group',{attrs:{\"tag\":\"ul\",\"name\":\"list\"}},_vm._l((_vm.skuList),function(item,i){return _c('li',{key:item._id},[_c('row',[_c('row',{attrs:{\"flex\":\"1\"}},[_c('el-form-item',{attrs:{\"label\":\"名字\"}},[_c('el-input',{attrs:{\"disabled\":!!(item.frameUploadedSize || item.thumbUploadedSize)},on:{\"change\":function (value) { return item.color = item.color || value; }},model:{value:(item.collocationName),callback:function ($$v) {_vm.$set(item, \"collocationName\", $$v)},expression:\"item.collocationName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"颜色\"}},[_c('el-input',{model:{value:(item.color),callback:function ($$v) {_vm.$set(item, \"color\", $$v)},expression:\"item.color\"}})],1),_c('el-form-item',{attrs:{\"label\":\"数量\"}},[_c('el-input',{model:{value:(item.thumbLength),callback:function ($$v) {_vm.$set(item, \"thumbLength\", $$v)},expression:\"item.thumbLength\"}})],1)],1),_c('row',{attrs:{\"flex\":\"1\"}},[_c('el-form-item',{attrs:{\"label-width\":\"0\"}},[_c('el-progress',{staticStyle:{\"width\":\"100px\",\"margin-top\":\"7px\",\"margin-left\":\"10px\",\"display\":\"inline-block\"},attrs:{\"text-inside\":true,\"stroke-width\":26,\"percentage\":_vm.percentages[i]}}),_c('span',{staticClass:\"percentage-text\"},[_vm._v(\" \"+_vm._s(item.thumbUploadedSize + item.frameUploadedSize)+\" / \"+_vm._s(item.thumbFiles.length + item.frameFiles.length)+\" \")]),(item.thumbFiles.length + item.frameFiles.length)?_c('el-button-group',[_c('el-button',{staticStyle:{\"margin-left\":\"10px\",\"height\":\"40px\"},attrs:{\"disabled\":item.isUploading,\"size\":\"small\"},on:{\"click\":function($event){return _vm.$act(_vm.uploadSku, [item, _vm.form.modelNumber])}}},[_vm._v(\"上传 \")]),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\"},on:{\"click\":function($event){return _vm.$act(_vm.clearSkuFiles, [item])}}})],1):_c('label',{staticClass:\"el-button el-button--primary\",staticStyle:{\"margin-left\":\"10px\",\"height\":\"40px\"}},[_c('span',[_vm._v(\"选择sku资源\")]),_c('input',{attrs:{\"type\":\"file\",\"webkitdirectory\":\"\",\"multiple\":\"\"},on:{\"change\":function (e) {\n                      _vm.$act(_vm.pickSku, [e.target.files, item]);\n                      e.target.value = null\n                    }}})])],1)],1),_c('div',[_c('el-button-group',{staticStyle:{\"margin-right\":\"10px\"}},[_c('el-button',{staticStyle:{\"height\":\"40px\"},attrs:{\"size\":\"small\",\"disabled\":i === 0},on:{\"click\":function($event){return _vm.upSku(i, item)}}},[_vm._v(\"上 \")]),_c('el-button',{staticStyle:{\"height\":\"40px\"},attrs:{\"size\":\"small\",\"disabled\":i === _vm.skuList.length - 1},on:{\"click\":function($event){return _vm.downSku(i, item)}}},[_vm._v(\"下\")])],1),_c('el-button',{staticStyle:{\"height\":\"40px\"},attrs:{\"type\":\"danger\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteItem(i, item)}}},[_vm._v(\"删除\")])],1)],1),_c('el-divider')],1)}),0)],1)],1),_c('section',{staticClass:\"upload-section submit\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.$act(_vm.submit)}}},[_vm._v(\"提交\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"upload-model-info\" ref=\"orderMeetingUpload\">\n    <!-- 标题 -->\n    <h1 class=\"section-title\">基本信息</h1>\n\n    <el-form :model=\"form\" :rules=\"rules\" class=\"custom-form clearfix\" ref=\"form\">\n\n      <el-form-item prop=\"modelNumber\" label=\"形体名\">\n        <el-input v-model=\"form.modelNumber\" @change=\"(v) => form.barCode = form.barCode || v\" />\n      </el-form-item>\n\n      <el-form-item prop=\"barCode\" label=\"编码\">\n        <el-input v-model=\"form.barCode\" />\n      </el-form-item>\n\n      <el-form-item prop=\"season\" label=\"季度\">\n        <el-input v-model=\"form.season\" />\n      </el-form-item>\n\n      <el-form-item prop=\"series\" label=\"系列\">\n        <el-input v-model=\"form.series\" />\n      </el-form-item>\n\n      <el-form-item prop=\"price\" label=\"单价\" style=\"height: 80px;\">\n        <input-with-unit\n          :value=\"form.price\"\n          :default-unit=\"form.monetaryUnit\"\n          :unit-options=\"[\n              { value: 'USD', label: $i18n.i18next.language === 'en' ? 'USD' : '美元' },\n              { value: 'CNY', label: $i18n.i18next.language === 'en' ? 'CNY' : '人民币' }\n            ]\"\n          input-placeholder=\"\"\n          :threshold=\"2000\"\n          @on-input-blur=\"form.price = $event\"\n          @on-select-change=\"form.monetaryUnit = $event\" />\n      </el-form-item>\n\n      <el-form-item prop=\"size\" label=\"尺码（输入后请回车）\">\n        <vue-input-tag\n          @input=\"(tags) => form.size = tags.join(',')\"\n          :value=\"form.size === '' ? [] :  form.size.split(',')\" />\n      </el-form-item>\n\n      <!-- 其他信息 -->\n      <custom-collapse title=\"其他信息\" class=\"width-100 clearfix\" colsed>\n        <el-form-item prop=\"shoeInfoExtraField.materials\" label=\"缩略图\"\n          style=\"padding-right: 60px; width: 25%\">\n          <row>\n            <label class=\"upload-thumb\">\n              <input type=\"file\"\n                hidden\n                @change=\"(e) => {\n                $act(pickThumb, [e.target.files[e.target.files.length - 1]]);\n                e.target.value = null\n              }\" />\n              <BaseImage :fit=\"cover\" :src=\"curtailImgUrl\" style=\"width: 173px; height: 130px;\" />\n            </label>\n          </row>\n\n        </el-form-item>\n        <el-form-item prop=\"shoeInfoExtraField.materials\" label=\"4ds\"\n          style=\"padding-right: 60px; width: 25%\">\n          <row>\n            <label class=\"upload-thumb\">\n              <input type=\"file\"\n                hidden\n                accept=\".4ds\"\n                @change=\"(e) => {\n                $act(pick4ds, [e.target.files[0]]);\n                e.target.value = null\n              }\" />\n\n              <div class=\"file-icon\">\n                <template v-if=\"form['4dsFile']\">\n                  <i class=\"iconfont iconliebiao\" />\n                  <div class=\"name\">{{form['4dsFile'].name}}</div>\n                </template>\n                <i class=\"iconfont icon-add\" v-else />\n              </div>\n            </label>\n          </row>\n\n        </el-form-item>\n        <el-form-item prop=\"shoeInfoExtraField.inspiration\" label=\"描述\">\n          <div style=\"height: 134px\">\n            <el-input type=\"textarea\" v-model=\"form.shoeInfoExtraField.inspiration\" :rows=\"6\" />\n          </div>\n        </el-form-item>\n        <el-form-item prop=\"thumbFiles\" label=\"面料\">\n          <el-input v-model=\"form.shoeInfoExtraField.materials\" />\n        </el-form-item>\n\n        <el-form-item prop=\"shoeInfoExtraField.width\" label=\"宽度\">\n          <el-input v-model=\"form.shoeInfoExtraField.width\" />\n        </el-form-item>\n\n        <el-form-item prop=\"shoeInfoExtraField.weight\" label=\"重量\">\n          <el-input v-model=\"form.shoeInfoExtraField.weight\" />\n        </el-form-item>\n\n        <el-form-item prop=\"shoeInfoExtraField.dimensions\" label=\"边界尺寸\">\n          <el-input v-model=\"form.shoeInfoExtraField.dimensions\" />\n        </el-form-item>\n\n      </custom-collapse>\n    </el-form>\n\n    <!-- SKU -->\n    <custom-collapse title=\"SKU\" class=\"width-100 clearfix\">\n      <div class=\"text-align-right\" style=\"margin-bottom: 10px;\">\n        <el-button @click=\"add()\" type=\"success\">添加</el-button>\n        <label class=\"el-button el-button--primary\">\n          <span>批量添加sku以及文件</span>\n          <input type=\"file\"\n            webkitdirectory multiple @change=\"(e) => {\n              $act(batchPickSku, [e.target.files]);\n              e.target.value = null\n            }\" />\n        </label>\n      </div>\n      <el-form class=\"sku-form clearfix\" label-width=\"5em\">\n        <transition-group tag=\"ul\" name=\"list\">\n          <li v-for=\"(item, i) in skuList\" :key=\"item._id\">\n            <row>\n              <row flex=\"1\">\n                <el-form-item label=\"名字\">\n                  <el-input\n                    :disabled=\"!!(item.frameUploadedSize || item.thumbUploadedSize)\"\n                    v-model=\"item.collocationName\"\n                    @change=\"(value) => item.color = item.color || value\" />\n                </el-form-item>\n                <el-form-item label=\"颜色\">\n                  <el-input\n                    v-model=\"item.color\" />\n                </el-form-item>\n                <el-form-item label=\"数量\">\n                  <el-input v-model=\"item.thumbLength\" />\n                </el-form-item>\n              </row>\n              <row flex=\"1\">\n                <el-form-item label-width=\"0\">\n                  <el-progress\n                    style=\"width: 100px; margin-top: 7px; margin-left: 10px; display: inline-block\"\n                    :text-inside=\"true\"\n                    :stroke-width=\"26\"\n                    :percentage=\"percentages[i]\" />\n                  <span class=\"percentage-text\">\n                    {{item.thumbUploadedSize + item.frameUploadedSize}} /\n                    {{item.thumbFiles.length + item.frameFiles.length}}\n                  </span>\n                  <el-button-group v-if=\"item.thumbFiles.length + item.frameFiles.length\">\n                    <el-button\n                      @click=\"$act(uploadSku, [item, form.modelNumber])\"\n                      :disabled=\"item.isUploading\"\n                      size=\"small\" style=\"margin-left: 10px;height: 40px;\">上传\n                    </el-button>\n                    <el-button type=\"danger\"\n                      icon=\"el-icon-delete\" @click=\"$act(clearSkuFiles, [item])\"></el-button>\n                  </el-button-group>\n                  <label class=\"el-button el-button--primary\"\n                    style=\"margin-left: 10px;height: 40px;\"\n                    v-else>\n                    <span>选择sku资源</span>\n                    <input type=\"file\"\n                      webkitdirectory multiple\n                      @change=\"(e) => {\n                        $act(pickSku, [e.target.files, item]);\n                        e.target.value = null\n                      }\" />\n                  </label>\n\n                </el-form-item>\n              </row>\n              <div>\n                <el-button-group style=\"margin-right: 10px;\">\n                  <el-button\n                    style=\"height: 40px;\"\n                    size=\"small\" @click=\"upSku(i, item)\" :disabled=\"i === 0\">上\n                  </el-button>\n                  <el-button\n                    style=\"height: 40px;\"\n                    size=\"small\" @click=\"downSku(i, item)\"\n                    :disabled=\"i === skuList.length - 1\">下</el-button>\n                </el-button-group>\n                <el-button\n                  type=\"danger\"\n                  size=\"small\" style=\"height: 40px;\"\n                  @click=\"deleteItem(i, item)\">删除</el-button>\n              </div>\n\n              <!--<input type=\"file\" webkitdirectory multiple @change=\"uploadSku\" />-->\n\n            </row>\n            <el-divider></el-divider>\n          </li>\n        </transition-group>\n      </el-form>\n    </custom-collapse>\n\n    <!-- 上传按钮 -->\n    <section class=\"upload-section submit\">\n      <!-- <el-button @click=\"$router.push({ name: 'FileList' })\">Cancel</el-button> -->\n      <el-button type=\"primary\" @click=\"$act(submit)\">提交</el-button>\n    </section>\n  </div>\n</template>\n\n<script>\nimport Vue from 'vue';\n\nimport VueInputTag from 'vue-input-tag';\nimport CustomCollapse from '@/components/collapse/Collapse';\nimport InputWithUnit from '@/components/form/InputWithUnit';\nimport BaseImage from '@/components/base/Image';\nimport mixinLoading from '@/mixins/loading';\nimport { mixinValidateForm } from '@/mixins/form-validation';\n\nimport validator, { validateFormFields } from '@/utils/validators/rules-validation';\nimport uploadToOSS from '@/utils/oss/uploadToOSS';\nimport { uploadBasicInfo } from '@/api/order-meeting';\nimport OSSUploader from '@/utils/oss/uploader';\nimport { sts, getParams } from '@/utils/oss/utils';\nimport { clientShoeUpload } from '@/api/shoe';\nimport envs from '@/utils/envs';\nimport getExt from '_/get-ext';\n\nfunction arrFiles2MapFiles(files, basePath = '') {\n  let mapFiles = {};\n  if ('length' in files) {\n    files = [...files];\n    files.forEach(file => {\n      mapFiles[file.webkitRelativePath ?? file.name] = file;\n    });\n  } else {\n    mapFiles = { ...files };\n  }\n  if (basePath) {\n    Object.keys(mapFiles).forEach(path => {\n      if (path.startsWith(basePath)) {\n        mapFiles[path.slice(basePath.length)] = mapFiles[path];\n      }\n      delete mapFiles[path];\n    });\n  }\n  return mapFiles;\n}\n\nconst ossUploader = new OSSUploader({\n  async getParams() {\n    const stsData = await sts();\n    return {\n      ...stsData,\n      bucket: 'order-meeting',\n    };\n  },\n});\n\nexport default Vue.extend({\n  name: 'OrderMeetingUpload',\n  components: {\n    CustomCollapse,\n    InputWithUnit,\n    VueInputTag,\n    BaseImage,\n  },\n  props: {\n    workspaceId: {\n      default() {\n        return '';\n      },\n    },\n  },\n  mixins: [mixinLoading, mixinValidateForm],\n  data() {\n    return {\n      form: {\n        curtailImgFile: undefined,\n        '4dsFile': undefined,\n        // 后台配置的字典\n        parentFolderId: '-1',\n        appType: 13,\n        // 基本信息\n        workspaceId: '',\n        modelNumber: '',\n        barCode: '',\n        season: '',\n        series: '',\n        size: '',\n        price: '',\n        monetaryUnit: 'CNY',\n        // 新添加字段\n        shoeInfoExtraField: {\n          materials: '',\n          width: '',\n          weight: '',\n          dimensions: '',\n          inspiration: '',\n        },\n      },\n      rules: {\n        workspaceId: validator.rules('requirement'),\n        modelNumber: validator.rules('requirement'),\n        barCode: validator.rules('requirement'),\n        season: validator.rules('requirement'),\n        series: validator.rules('requirement'),\n        size: validator.rules('requirement'),\n        price: validator.rules('requirement'),\n        monetaryUnit: validator.rules('requirement'),\n      },\n      skuLules: {\n        collocationName: validator.rules('requirement'),\n        color: validator.rules('requirement'),\n      },\n      skuList: [],\n    };\n  },\n  created() {\n    if (!this.workspaceId) {\n      throw new Error('非法路径');\n    }\n  },\n  watch: {\n    curtailImgUrl(newUrl, oldUrl) {\n      if (oldUrl) {\n        URL.revokeObjectURL(oldUrl);\n      }\n    },\n  },\n  computed: {\n    curtailImgUrl() {\n      if (!this.form.curtailImgFile) {\n        return undefined;\n      }\n      return URL.createObjectURL(this.form.curtailImgFile);\n    },\n    percentages() {\n      return this.skuList.map(item => {\n        const s = item.thumbFiles.length + item.frameFiles.length;\n        // debugger;\n        if (!s) return 0;\n        return parseInt(\n          (item.thumbUploadedSize + item.frameUploadedSize) * 100 / s,\n          10,\n        );\n      });\n    },\n    styleNameReadonly() {\n      return !!this.skuList.reduce((memo, item) => {\n        return memo + item.thumbFiles.length + item.frameFiles.length;\n      }, 0);\n    },\n  },\n  methods: {\n    pickThumb(file) {\n      this.form.curtailImgFile = file;\n    },\n    pick4ds(file) {\n      const ext = getExt(file);\n      if (ext !== '4ds') {\n        throw new Error('您选的不是 4ds 文件');\n      }\n      this.form['4dsFile'] = file;\n    },\n    createSku(name = '') {\n      const item = {\n        _id: Date.now(),\n        collocationName: name,\n        color: name,\n        thumbLength: 4,\n        // 是否用thump.jpg作为列表展示图，否则用1.jpg\n        useThumbJPG: false,\n        threeDimensional: undefined,\n        thumbUploadedSize: 0,\n        thumbFiles: [],\n        frameUploadedSize: 0,\n        frameFiles: [],\n        isUploading: false,\n      };\n      return item;\n    },\n    add(name = '') {\n      const item = this.createSku(name);\n      this.skuList.push(item);\n      return item;\n    },\n    deleteItem(i, sku) {\n      sku.isUploading = false;\n      this.skuList.splice(i, 1);\n    },\n    clearSkuFiles(sku) {\n      sku.isUploading = false;\n      sku.thumbFiles = [];\n      sku.frameFiles = [];\n      sku.thumbUploadedSize = 0;\n      sku.frameUploadedSize = 0;\n    },\n    upSku(i, item) {\n      if (i === 0) return;\n      this.skuList.splice(i, 1);\n      this.skuList.splice(i - 1, 0, item);\n    },\n    downSku(i, item) {\n      if (i === this.skuList.length - 1) return;\n      this.skuList.splice(i, 1);\n      this.skuList.splice(i + 1, 0, item);\n    },\n    async pickSku(files, sku) {\n      files = arrFiles2MapFiles(files);\n      console.info(files);\n      if (\n        !(sku.thumbFiles.length + sku.frameFiles.length)\n        || ((sku.thumbFiles.length + sku.frameFiles.length)\n          && await this.$confirmBool(`此操作会清除sku${sku.collocationName}的所有文件,\\n是否确认?`, 'Info', {\n            confirmButtonText: '确认',\n            cancelButtonText: '取消',\n            closeOnClickModal: false,\n            type: 'warning',\n          }))\n      ) {\n        const rThumb = /([^/]+)\\/(\\d+).jpe?g/;\n        // 用于列表展示的图片正则\n        const rListThumb = /([^/]+)\\/thumb.jpe?g/;\n        const r360 = /([^/]+)\\/360\\/(\\d+)_(\\d+).jpe?g/;\n        let keyframeXaxisLength;\n        let keyframeYaxisLength;\n        let thumbLength;\n        let useThumbJPG = false;\n        let collocationName;\n        const thumbFiles = [];\n        const frameFiles = [];\n        // 用于列表展示的图片\n        // const thumb = '';\n        Object.keys(files).forEach(path => {\n          const item = files[path];\n          const matchListThumb = item.webkitRelativePath.match(rListThumb);\n          const matchThumb = item.webkitRelativePath.match(rThumb);\n          const matchFrame = item.webkitRelativePath.match(r360);\n          if (matchFrame || matchThumb) {\n            collocationName = matchThumb?.[1] ?? matchFrame[1];\n          }\n          if (matchThumb) {\n            thumbLength = thumbLength ?? 0;\n            thumbLength = Math.max(thumbLength, parseInt(matchThumb[2], 10));\n            thumbFiles.push(item);\n          }\n          // 缩略图必须在后面\n          if (matchListThumb) {\n            thumbFiles.unshift(item);\n            useThumbJPG = true;\n          }\n          if (matchFrame) {\n            keyframeXaxisLength = keyframeXaxisLength ?? 0;\n            keyframeXaxisLength = Math.max(\n              keyframeXaxisLength,\n              parseInt(matchFrame[3], 10) + 1,\n            );\n            keyframeYaxisLength = keyframeYaxisLength ?? 0;\n            keyframeYaxisLength = Math.max(\n              keyframeYaxisLength,\n              parseInt(matchFrame[2], 10) + 1,\n            );\n            frameFiles.push(item);\n          }\n        });\n        if (collocationName) {\n          sku.collocationName = collocationName;\n        }\n        if (keyframeYaxisLength !== undefined || keyframeXaxisLength !== undefined) {\n          sku.threeDimensional = {\n            keyframeYaxisLength,\n            keyframeXaxisLength,\n          };\n        }\n        if (thumbLength !== undefined) {\n          sku.thumbLength = thumbLength;\n        }\n        sku.useThumbJPG = useThumbJPG;\n        sku.thumbFiles = thumbFiles;\n        sku.frameFiles = frameFiles;\n        if (this.skuList.length === 1\n          && this.skuList[0] === sku\n          && this.form.curtailImgFile === undefined) {\n          // [this.form.curtailImgFile;] = sku.thumbFiles;\n          console.info(sku.thumbFiles);\n          [this.form.curtailImgFile] = sku.thumbFiles;\n        }\n      }\n    },\n\n    async batchPickSku(files) {\n      files = [...files];\n      const rDirectory = /([^/]+)\\/([^/]+)\\/\\w/;\n      let styleName;\n      const skuFiles = {};\n\n      files.forEach(item => {\n        const matchDirectory = item.webkitRelativePath.match(rDirectory);\n        if (matchDirectory) {\n          if (!styleName) {\n            [, styleName] = matchDirectory;\n          }\n          const skuName = matchDirectory[2];\n          skuFiles[skuName] = skuFiles[skuName] || {};\n          skuFiles[skuName][item.webkitRelativePath] = item;\n        }\n      });\n      this.form.modelNumber = this.form.modelNumber || styleName;\n      this.form.barCode = this.form.barCode || styleName;\n      const skuNames = Object.keys(skuFiles);\n      return skuNames.map(async name => {\n        let sku = this.getSkuByName(name);\n        if (!sku) {\n          sku = this.add(name);\n        }\n        await this.pickSku(arrFiles2MapFiles(skuFiles[sku.collocationName], `${styleName}/`), sku);\n        return sku;\n      });\n    },\n    getSkuByName(name) {\n      return this.skuList.find(item => item.collocationName === name);\n    },\n    async uploadSku(sku, styleName) {\n      if (sku.isUploading === false) {\n        sku.isUploading = true;\n        for (let i = sku.frameUploadedSize; i < sku.frameFiles.length; i++) {\n          if (!sku.isUploading) break;\n          const file = sku.frameFiles[i];\n          await ossUploader.send({\n            body: file,\n            params: {\n              key: `order-meeting/${envs.VUE_APP_MODE}/${this.workspaceId}/collocations/${styleName}/${sku.collocationName}/360/${file.name}`,\n            },\n          });\n          sku.frameUploadedSize = i + 1;\n        }\n        for (let i = sku.thumbUploadedSize; i < sku.thumbFiles.length; i++) {\n          if (!sku.isUploading) break;\n          const file = sku.thumbFiles[i];\n          await ossUploader.send({\n            body: file,\n            params: {\n              key: `order-meeting/${envs.VUE_APP_MODE}/${this.workspaceId}/collocations/${styleName}/${sku.collocationName}/${file.name}`,\n            },\n          });\n          sku.thumbUploadedSize = i + 1;\n        }\n      }\n\n      sku.isUploading = false;\n    },\n    async upload() {\n      for (let i = 0; i < this.skuList.length; i++) {\n        await this.uploadSku(this.skuList[i], this.form.modelNumber);\n      }\n    },\n    async submit() {\n      try {\n        const { curtailImgFile, '4dsFile': file4ds, ...payload } = this.form;\n        payload.workspaceId = this.workspaceId;\n\n\n        await validateFormFields(this.$refs.form);\n\n\n        this.startLoading('正在上传缩略图...');\n\n        const curtailImg = await uploadToOSS(curtailImgFile, 'SHOE');\n        payload.curtailImg = curtailImg;\n\n        this.startLoading('正在上传sku资源...');\n        await this.upload();\n        // 将sku的列表数据处理完数据结构后放入form里\n\n        payload.collocationUploadRequestList = this.skuList.map(item => {\n          const {\n            thumbLength, collocationName, threeDimensional, color, useThumbJPG,\n          } = item;\n\n          // 循环生成 thumbnailName 字段\n          const names = [];\n          const len = Math.ceil(thumbLength);\n          if (len >= 1) {\n            for (let i = 1; i <= len; i++) {\n              names.push(`${i}.jpg`);\n            }\n          }\n\n          return {\n            collocationName,\n            color,\n            threeDimensional,\n            resourceUrl: `/order-meeting/${envs.VUE_APP_MODE}/${this.workspaceId}/collocations/${this.form.modelNumber}/${collocationName}`,\n            thumbnailName: names.join(','),\n            mainThumbnailName: useThumbJPG ? 'thumb.jpg' : '1.jpg',\n          };\n        });\n\n\n        const shoeId = (await uploadBasicInfo(this.form.workspaceId, payload)).data.relateId;\n\n        let file4dsParams;\n        if (file4ds) {\n          this.startLoading('正在计算4ds文件路径...');\n          file4dsParams = await getParams(file4ds, { sourceType: '4DS' });\n          await clientShoeUpload({\n            shoeId,\n            components: [{\n              type: 1,\n              name: file4ds.name,\n              ossKey: file4dsParams.path,\n              fileSize: file4ds.size,\n            }],\n          }, this.workspaceId);\n          if (file4ds.size > 10 * 1024 * 1024) {\n            this.$prompt('复制下面的文件路径并将文件发给开发人员手动上传', '4Ds文件太大了', {\n              confirmButtonText: '确定',\n              cancelButtonText: '取消',\n              inputValue: file4dsParams.path,\n              closeOnClickModal: false,\n            });\n          } else {\n            this.startLoading('正在上传4ds...');\n            await OSSUploader.send({\n              params: file4dsParams,\n              body: file4ds,\n            });\n          }\n        }\n\n        this.$message.success('Upload Succeeded!');\n        this._refreshPage(); // 上传完后初始化表单数据\n      } finally {\n        this.endLoading();\n      }\n    },\n    // 将页面数据初始化\n    _refreshPage() {\n      this.$refs.form.resetFields();\n      this.form.curtailImgFile = null;\n      this.skuList = [];\n      this.form['4dsFile'] = null;\n    },\n  },\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.list-enter-active,\n.list-leave-active {\n  transition: all 0.2s;\n}\n.list-enter,\n.list-leave-to {\n  opacity: 0;\n  transform: translateX(15%);\n}\n.list-move {\n  transition: transform 0.2s;\n}\n.el-button {\n  input[type=\"file\"] {\n    position: absolute;\n    visibility: hidden;\n  }\n}\n.percentage-text {\n  display: inline-block;\n  margin-left: 10px;\n  line-height: 20px;\n  padding-top: 10px;\n  padding-bottom: 10px;\n}\n\n.custom-form {\n  display: flex;\n  flex-wrap: wrap;\n  /deep/ {\n    > .collapse-custom {\n      width: 100%;\n    }\n    .el-form-item__label {\n      float: none;\n    }\n  }\n\n  .el-form-item {\n    float: left;\n    width: 50%;\n    padding-right: 120px;\n    margin-bottom: 15px;\n  }\n}\n\n.upload-model-info {\n  padding: 40px 55px;\n  .section-title {\n    font-size: 24px;\n    color: #333;\n  }\n}\n\n.upload-thumb {\n  display: block;\n  font-size: 0;\n  cursor: pointer;\n  border: 1px solid #dcdfe6;\n  padding: 1px;\n  height: 134px;\n  > * {\n    font-size: 14px;\n  }\n  .file-icon {\n    width: 130px;\n    height: 130px;\n    text-align: center;\n    i {\n      display: block;\n    }\n    .icon-add {\n      font-size: 50px;\n      line-height: 130px;\n    }\n    .iconliebiao {\n      font-size: 50px;\n      line-height: 80px;\n    }\n    .name {\n      line-height: 20px;\n      height: 40px;\n      margin: 5px;\n      overflow: hidden;\n    }\n  }\n}\n\n.upload-section {\n  margin-top: 20px;\n  background: #fff;\n  border-radius: 4px;\n  &.submit {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    height: 80px;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=670a2151&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=670a2151&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"670a2151\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputWithUnit.vue?vue&type=style&index=0&id=6e6c8f9d&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"input-unit\"},[_c('el-input',{staticClass:\"input-unit-number\",attrs:{\"placeholder\":_vm.inputPlaceholder,\"disabled\":_vm.disabled},nativeOn:{\"keyup\":function($event){return _vm.handleChangeUnitNumber($event)}},model:{value:(_vm.text),callback:function ($$v) {_vm.text=$$v},expression:\"text\"}}),(!_vm.withoutSelect)?_c('el-select',{staticClass:\"input-unit-unit\",attrs:{\"disabled\":_vm.disabled},on:{\"change\":function($event){return _vm.$emit('on-select-change', _vm.selectedUnit)}},model:{value:(_vm.selectedUnit),callback:function ($$v) {_vm.selectedUnit=$$v},expression:\"selectedUnit\"}},_vm._l((_vm.unitOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"input-unit\">\n    <el-input\n      v-model=\"text\"\n      :placeholder=\"inputPlaceholder\"\n      :disabled=\"disabled\"\n      class=\"input-unit-number\"\n      @keyup.native=\"handleChangeUnitNumber\" />\n    <el-select\n      v-if=\"!withoutSelect\"\n      v-model=\"selectedUnit\"\n      :disabled=\"disabled\"\n      class=\"input-unit-unit\"\n      @change=\"$emit('on-select-change', selectedUnit)\">\n      <el-option\n        v-for=\"item in unitOptions\"\n        :key=\"item.value\"\n        :label=\"item.label\"\n        :value=\"item.value\" />\n    </el-select>\n  </div>\n</template>\n\n<script>\nimport i18n from 'i18next';\nimport { debounce } from 'throttle-debounce';\n\nexport default {\n  props: {\n    // 不要select\n    withoutSelect: {\n      type: Boolean,\n      default: false,\n    },\n    // 输入框值\n    value: {\n      type: [String, Number],\n      default: '',\n    },\n    // 输入框 placeholder\n    inputPlaceholder: {\n      type: String,\n      default: '',\n    },\n    // 单位选择 默认选择的单位\n    defaultUnit: {\n      type: [String, Number],\n      default: '',\n    },\n    // 单位选择数组\n    unitOptions: {\n      type: Array,\n      required: true,\n    },\n    // 小数点后保留位数(最大不能超过8位)\n    decimalPlaces: {\n      type: Number,\n      default: 2,\n    },\n    // 整数位数(最大不能超过7位)\n    integerPlaces: {\n      type: Number,\n      default: 8,\n    },\n    // 间隔阈值\n    threshold: {\n      type: Number,\n      default: 500,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  data() {\n    return {\n      text: '',\n      selectedUnit: '',\n    };\n  },\n  mounted() {\n    this.text = this.value;\n    this.selectedUnit = this.defaultUnit;\n    // eslint-disable-next-line func-names\n    this.handleChangeUnitNumber = debounce(this.threshold, function () {\n      this.changeUnitNumber();\n    });\n  },\n  watch: {\n    value(value) {\n      this.text = value;\n    },\n    defaultUnit(value) {\n      this.selectedUnit = value;\n    },\n  },\n  methods: {\n    // debouce 延迟处理键盘输入校验\n    // eslint-disable-next-line\n    // handleChangeUnitNumber: debounce(function () {\n    //   this.changeUnitNumber();\n    // }, this.threshold),\n    changeUnitNumber() {\n      if (this.text === '') {\n        this.$emit('on-input-blur', this.text);\n        return;\n      }\n\n      // 暂时保存原始的输入的文本\n      const temp = this.text;\n      const limitInt = this._addNumberSeparator();\n\n      this.text = parseFloat(this.text, 10);\n      // 处理非数字类型\n      if (Number.isNaN(this.text)) this.text = '';\n      // 处理负数情况\n      if (this.text < 0) this.text = -this.text;\n\n      // 处理科学法情况\n      if (String(this.text).includes('e')) {\n        this.$message.warning(i18n.t('public.form.max_num_exceed', { limit: limitInt }));\n        this.text = String(temp).slice(0, this.integerPlaces);\n        return;\n      }\n\n      // 最大值处理\n      if (this.text >= `1${'0'.repeat(this.integerPlaces)}`) {\n        this.$message.warning(i18n.t('public.form.max_num_exceed', { limit: limitInt }));\n        this.text = String(this.text).slice(0, this.integerPlaces);\n        return;\n      }\n      // 小数点处理\n      const isDecimal = String(this.text).includes('.');\n      if (isDecimal) this._handleDecimalNumber();\n\n      this.$emit('on-input-blur', this.text);\n    },\n    // 处理小数点情况\n    _handleDecimalNumber() {\n      const number = Math.round(this.decimalPlaces);\n      const [int, dec] = String(this.text).split('.');\n      if (number <= 0) {\n        this.text = int;\n      } else if (number >= 8) {\n        this.text = `${int}.${dec.slice(0, 8)}`;\n        this.$message.warning(i18n.t('public.form.keep_decimal_places', { num: 8 }));\n      } else if (dec.length > number) {\n        this.text = `${int}.${dec.slice(0, number)}`;\n        this.$message.warning(i18n.t('public.form.keep_decimal_places', { num: number }));\n      }\n    },\n    // 处理数字分隔符问题\n    _addNumberSeparator() {\n      const number = Number(`1${'0'.repeat(this.integerPlaces)}`);\n      return number.toLocaleString('en-US');\n    },\n  },\n};\n</script>\n\n<style scoped>\n.input-unit {\n  display: flex;\n  height: 33px;\n}\n.input-unit-number {\n  margin-right: 10px;\n}\n.input-unit-unit {\n  width: 140px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputWithUnit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./InputWithUnit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./InputWithUnit.vue?vue&type=template&id=6e6c8f9d&scoped=true&\"\nimport script from \"./InputWithUnit.vue?vue&type=script&lang=js&\"\nexport * from \"./InputWithUnit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./InputWithUnit.vue?vue&type=style&index=0&id=6e6c8f9d&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6e6c8f9d\",\n  null\n  \n)\n\nexport default component.exports","import { Loading } from 'element-ui';\n\nexport default {\n  data() {\n    return {\n      loadingVeil: null,\n    };\n  },\n  methods: {\n    // Show Loading veil\n    startLoading(text) {\n      if (!this.loadingVeil) {\n        this.loadingVeil = Loading.service({\n          lock: true,\n          text,\n          background: 'rgba(0, 0, 0, 0.7)',\n        });\n      } else {\n        this.loadingVeil.text = text;\n      }\n    },\n    // Hide loading veil\n    endLoading() {\n      if (this.loadingVeil) {\n        this.loadingVeil.close();\n        this.loadingVeil = null;\n      }\n    },\n  },\n};\n","var $ = require('../internals/export');\n\n// `Number.isNaN` method\n// https://tc39.github.io/ecma262/#sec-number.isnan\n$({ target: 'Number', stat: true }, {\n  isNaN: function isNaN(number) {\n    // eslint-disable-next-line no-self-compare\n    return number != number;\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Collapse.vue?vue&type=style&index=0&id=f67e9690&lang=scss&scoped=true&\"","var render, staticRenderFns\nimport script from \"./Collapse.vue?vue&type=script&lang=js&\"\nexport * from \"./Collapse.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Collapse.vue?vue&type=style&index=0&id=f67e9690&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f67e9690\",\n  null\n  \n)\n\nexport default component.exports","<script>\nimport i18n from 'i18next';\n\nexport default {\n  name: 'CustomCollaps',\n  functional: true,\n  props: {\n    /**\n     * 标题名称\n     */\n    title: {\n      type: String,\n      default: i18n.t('public.title'),\n    },\n    /**\n     * 标题的CSS\n     */\n    styles: {\n      type: Object,\n      default: () => ({}),\n    },\n\n    divider: {\n      type: Boolean,\n      default: true,\n    },\n    /**\n     * 折叠展开的状态\n     */\n    closed: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  render(_, { props, slots }) {\n    return (\n      <el-collapse value=\"1-1\" class=\"collapse-custom\">\n        <el-collapse-item name={props.closed ? '' : '1-1'}>\n          <template slot=\"title\">\n            <h2 class={{ 'collapse-divider': props.divider }} style={props.styles}>{props.title}</h2>\n          </template>\n          {slots().default}\n        </el-collapse-item>\n      </el-collapse>\n    );\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.collapse-custom {\n  &.el-collapse,\n  .el-collapse-item__header,\n  .el-collapse-item__wrap {\n    border: none;\n  }\n\n  .el-icon-arrow-right {\n    font-size: 20px;\n  }\n\n  .collapse-divider {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    font-size: 16px;\n    font-weight: 600;\n    color: #333;\n\n    &::after {\n      content: \"\";\n      display: block;\n      flex: 1;\n      height: 1px;\n      margin-left: 20px;\n      margin-right: 10px;\n      background-color: #ddd;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Collapse.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Collapse.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=670a2151&lang=scss&scoped=true&\""],"sourceRoot":""}