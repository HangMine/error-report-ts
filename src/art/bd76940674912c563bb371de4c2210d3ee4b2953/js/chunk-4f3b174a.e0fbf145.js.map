{"version":3,"sources":["webpack:///./src/views/supplier-backend/components/HForm/utils.ts","webpack:///./src/views/supplier-backend/components/HTable/HModal.vue?939e","webpack:///src/views/supplier-backend/components/HTable/HModal.vue","webpack:///./src/views/supplier-backend/components/HTable/HModal.vue?4332","webpack:///./src/views/supplier-backend/components/HTable/HModal.vue","webpack:///./src/views/supplier-backend/components/HForm/index.vue","webpack:///./src/views/supplier-backend/components/HForm/index.vue?0997","webpack:///./src/views/supplier-backend/components/HForm/index.vue?6e5b","webpack:///./src/views/supplier-backend/components/HForm/index.vue?8189","webpack:///./src/views/supplier-backend/components/HTable/HModal.vue?97cb"],"names":["getClosetScrollEl","el","scrollHeight","clientHeight","parentElement","focus","offsetTop","HTMLElement","includes","tagName","scrollEl","scrollTo","unFalsy","_value","resetParams","formItems","params","item","type","key","multiple","childType","defaultValue","value","undefined","form2params","showFormItems","filter","show","render","_vm","this","_h","$createElement","_c","_self","_b","attrs","title","on","$event","$attrs","_t","form","ref","model","callback","$$v","formParams","expression","formProps","_e","staticClass","slot","_v","loading","commit","staticRenderFns","name","inheritAttrs","components","mixins","props","submit","Function","submitUrl","String","default","Boolean","Array","Object","handleParams","formValues","data","watch","handler","val","init","immediate","$emit","deep","created","mounted","methods","getParams","result","$refs","formCheck","url","method","component","cols","Number","gutter","disabled","formItemProps","labelPosition","validator","showInlineTitle","setup","root","emit","refs","that","unColsInline","inline","_gutter","currentCols","state","currentData","formItemStyle","width","toFixed","paddingRight","formStyle","marginRight","isUndefined","setDefaultAttrs","rules","map","_rule","required","message","placeholder","clearable","filterable","options","isRange","singlePlaceholder","rangePlaceholder","startPlaceholder","endPlaceholder","timePlaceholder","valueFormat","_class","class","defaultClass","setColsStyle","style","col","setOptions","optionsUrl","chainHanlder","_data","fns","reduce","memo","cur","handleData","handlers","_resetParams","pass","validate","valid","clearCheck","$nextTick","clearValidate","oldVal","$scopedSlots","$slots","publicFormItemProps","getFormItem","itemOptions","nativeOn","otherProps","scopedTag","dynamicProps","getOptions","optionKey","optionTitle","optionProps","optionAttrs","size","formItemClass","_formItemStyle","otherFormItemProps","right"],"mappings":"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","file":"js/chunk-4f3b174a.e0fbf145.js","sourcesContent":["import Vue from 'vue';\nimport { FormItems, Obj } from './type';\n\ntype FocusComp = Vue & { focus?:Function };\ntype FocusEl = HTMLElement & { focus?:Function };\ntype FocusObj = FocusComp | FocusEl;\nconst getClosetScrollEl = (el:HTMLElement):HTMLElement|null => {\n  const { scrollHeight, clientHeight } = el;\n  if (scrollHeight > clientHeight) {\n    return el;\n  }\n  if (el.parentElement) {\n    return getClosetScrollEl(el.parentElement);\n  }\n  return null;\n};\nexport function focus(el:FocusComp, offsetTop:number):void;\nexport function focus(el:FocusEl, offsetTop:number):void;\nexport function focus(el:FocusObj, offsetTop = 0):void {\n  if (el instanceof Vue) {\n    el.focus && el.focus();\n    return;\n  }\n  if (el instanceof HTMLElement) {\n    // 只写这几种先\n    if (['INPUT', 'TEXTAREA', 'SELECT'].includes(el.tagName)) {\n      el.focus();\n    } else {\n      const scrollEl = getClosetScrollEl(el);\n\n      if (scrollEl) {\n        scrollEl.scrollTo(0, el.offsetTop + offsetTop);\n      }\n    }\n  }\n}\nexport const unFalsy = (_value:any) => _value || _value === 0;\n\nexport const resetParams = (formItems:FormItems) => {\n  const params:Obj = {};\n  // eslint-disable-next-line no-restricted-syntax\n  for (const item of formItems) {\n    switch (item.type) {\n      case 'input':\n      default:\n        params[item.key] = '';\n        break;\n      case 'select':\n        params[item.key] = item.multiple ? [] : '';\n        break;\n      case 'date':\n        switch (item.childType) {\n          case 'daterange':\n          case 'datetimerange':\n            params[item.key] = [];\n            break;\n          default:\n            params[item.key] = '';\n            break;\n        }\n        break;\n      case 'checkbox':\n        params[item.key] = [];\n        break;\n      case 'switch':\n        params[item.key] = false;\n        break;\n      case 'block':\n        break;\n    }\n    const defaultValue = item.value;\n    if (defaultValue !== undefined) params[item.key] = defaultValue;\n  }\n  return params;\n};\n\nexport const form2params = (formItems:FormItems) => {\n  const showFormItems = formItems.filter(item => {\n    return item.show !== false;\n  });\n  return resetParams(showFormItems);\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-dialog',_vm._b({attrs:{\"title\":_vm.title,\"visible\":_vm.show,\"append-to-body\":\"\"},on:{\"update:visible\":function($event){_vm.show=$event}}},'el-dialog',_vm.$attrs,false),[_vm._t(\"default\",[(_vm.form.length)?_c('h-form',_vm._b({ref:\"form\",attrs:{\"data\":_vm.form},model:{value:(_vm.formParams),callback:function ($$v) {_vm.formParams=$$v},expression:\"formParams\"}},'h-form',_vm.formProps,false)):_vm._e()]),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.show = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\",\"loading\":_vm.loading},on:{\"click\":_vm.commit}},[_vm._v(\"确 定\")])],1)],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <el-dialog :title=\"title\" :visible.sync=\"show\" append-to-body v-bind=\"$attrs\">\n    <slot>\n      <h-form\n        v-if=\"form.length\"\n        :data=\"form\"\n        v-model=\"formParams\"\n        v-bind=\"formProps\"\n        ref=\"form\"\n      ></h-form>\n    </slot>\n\n    <div slot=\"footer\" class=\"dialog-footer\">\n      <el-button size=\"mini\" @click=\"show = false\">取 消</el-button>\n      <el-button type=\"primary\" size=\"mini\" :loading=\"loading\" @click=\"commit\"\n        >确 定</el-button\n      >\n    </div>\n  </el-dialog>\n</template>\n\n<script>\nimport axios from '@/utils/axios';\nimport HForm from '../HForm/index.vue';\nimport {\n  formCheck,\n} from './mixin';\nimport { deepCopy, getInitObj } from './utils';\n\nexport default {\n  name: 'h-modal',\n  inheritAttrs: false,\n  components: { HForm },\n  mixins: [formCheck],\n  props: {\n    // 待开发，传入一个返回promise的函数\n    submit: {\n      type: Function,\n    },\n    submitUrl: {\n      type: String,\n      default: '',\n    },\n    value: {\n      type: Boolean,\n      default: false,\n    },\n    form: {\n      type: Array,\n      default: () => [],\n    },\n    params: {\n      type: Object,\n      default: () => ({}),\n    },\n    handleParams: {\n      type: Function,\n    },\n    formProps: {\n      type: Object,\n      default: () => ({\n        size: 'small',\n      }),\n    },\n    title: {\n      type: String,\n      default: '模态框',\n    },\n    // 赋值的表单数据\n    formValues: {\n      type: Object,\n    },\n  },\n  data() {\n    return {\n      show: false,\n      loading: false,\n      // 表单参数\n      formParams: {},\n    };\n  },\n  watch: {\n    value: {\n      handler(val) {\n        this.show = val;\n        if (val) {\n          this.init();\n        }\n      },\n      immediate: true,\n    },\n    show(val) {\n      this.$emit('input', val);\n    },\n    formParams: {\n      handler(val) {\n        this.$emit('update:params', val);\n      },\n      deep: true,\n      immediate: true,\n    },\n  },\n  created() {},\n  mounted() {},\n  methods: {\n    getParams() {\n      if (typeof this.handleParams === 'function') {\n        const formParams = deepCopy(this.formParams);\n        const result = this.handleParams(formParams);\n        return result || formParams;\n      }\n      return this.formParams;\n    },\n    commit() {\n      if (!this.$refs.form.formCheck()) {\n        return;\n      }\n\n      this.loading = true;\n      axios({\n        url: this.submitUrl,\n        method: 'post',\n        data: this.getParams(),\n      })\n        .then(({ data }) => {\n          this.show = false;\n          this.$message.success(data.msg);\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n    // 打开时进行初始化，比如表单的校验和值的清除\n    async init() {\n      // 必须加nextTick，保证在form表单设置formParams后再执行getInitObj\n      await this.$nextTick();\n      this.formParams = getInitObj(this.formParams, this.formValues);\n      this.clearCheck('form');\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n/* @import 'url'; */\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./HModal.vue?vue&type=template&id=2485f312&\"\nimport script from \"./HModal.vue?vue&type=script&lang=js&\"\nexport * from \"./HModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./HModal.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render, staticRenderFns\nimport script from \"./index.vue?vue&type=script&lang=tsx&\"\nexport * from \"./index.vue?vue&type=script&lang=tsx&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport {\n  defineComponent, reactive, computed, toRefs, getCurrentInstance, watch, onMounted,\n} from '@vue/composition-api';\nimport {\n  FormItem, FormItems, Obj,\n} from './type';\n\nimport { resetParams } from './utils';\n\nexport * from './utils';\n\nexport default defineComponent({\n  name: 'h-form',\n  inheritAttrs: false,\n  props: {\n    data: {\n      type: Array as ()=> FormItems,\n      default: () => [],\n    },\n    value: {\n      type: Object,\n      default: () => ({}),\n    },\n    cols: {\n      type: [Number, String],\n    },\n    gutter: {\n      type: Number,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    formItemProps: {\n      type: Object,\n      default: () => ({}),\n    },\n    labelPosition: {\n      type: String,\n      default: 'top',\n      validator: (value:string) => ['top', 'left'].includes(value),\n    },\n    showInlineTitle: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  setup(props, { root, emit, refs }) {\n    const that = getCurrentInstance()!;\n    const {\n      cols, gutter,\n    } = props;\n    const { $attrs } = that;\n\n    const unColsInline = $attrs.inline === '' && !cols;\n\n    const _gutter = unColsInline ? undefined : `${gutter ?? 20}px`;\n\n    const currentCols = computed(() => (cols && +cols) || 2);\n\n    const state = reactive({\n      currentData: [] as FormItems,\n      params: {} as Obj,\n      formItemStyle: computed(() => {\n        if (unColsInline) {\n        // 如果是inline并且没有传递列数，不需设置宽度\n          return {};\n        }\n        const width = `${+(100 / currentCols.value).toFixed(1)}%`;\n\n        return {\n          width,\n          paddingRight: _gutter,\n        };\n      }),\n      // 根据间隔修改h-form的marginRight,隐藏最右边宽度\n      formStyle: computed(() => {\n        return {\n          marginRight: _gutter,\n        };\n      }),\n    });\n\n    watch(() => props.value, val => {\n      state.params = val;\n    }, { immediate: true });\n\n    watch(() => state.params, val => {\n      emit('input', val);\n    }, {\n      deep: true,\n    });\n\n    const isUndefined = (val:any) => val === undefined;\n\n    const setDefaultAttrs = (item:FormItem) => {\n      // 默认是input类型\n      if (!item.type) item.type = 'input';\n      // 设置rule\n      if (item.rules) {\n        item.rules = item.rules.map(_rule => (_rule.required ? { message: '不能为空', ..._rule } : _rule));\n      }\n      // 根据类型设置\n      switch (item.type) {\n        case 'input':\n        default:\n          item.placeholder = isUndefined(item.placeholder) ? `请输入${item.title}` : item.placeholder;\n          item.clearable = item.clearable === undefined ? true : item.clearable;\n          break;\n        case 'select':\n          item.placeholder = isUndefined(item.placeholder) ? `请选择${item.title}` : item.placeholder;\n          item.clearable = item.clearable === undefined ? true : item.clearable;\n          item.filterable = item.filterable === undefined ? true : item.filterable;\n          item.options = item.options || [];\n          // 对下拉框设置ref，因为iview有BUG，可搜索时，选中后重新打开下拉列表只剩上次选中的值\n          item.ref = `select-${item.key}`;\n          break;\n        case 'checkbox':\n        case 'radio':\n          item.options = item.options || [];\n          break;\n        case 'date':\n        { const isRange = item.childType?.includes('range');\n          const singlePlaceholder = { placeholder: isUndefined(item.placeholder) ? `请选择${item.title}` : item.placeholder };\n          const rangePlaceholder = {\n            startPlaceholder: isUndefined(item.startPlaceholder) ? '开始时间' : item.startPlaceholder,\n            endPlaceholder: isUndefined(item.endPlaceholder) ? '结束时间' : item.endPlaceholder,\n          };\n          const timePlaceholder = isRange ? rangePlaceholder : singlePlaceholder;\n          item.childType = item.childType || 'date';\n          // elementUI支持时间对象转换成字符串的功能，无需手动转换\n          item.valueFormat = item.valueFormat || 'timestamp';\n          item = { ...item, ...timePlaceholder };\n          break; }\n        case 'block':\n        { item.formItemProps = item.formItemProps || {};\n          const _class = item.formItemProps?.class || '';\n          const defaultClass = 'empty-item';\n          // 暂时不想支持数组的class\n          item.formItemProps.class = typeof _class === 'string' ? `${_class} ${defaultClass}` : { ..._class, [defaultClass]: true };\n          break; }\n      }\n      return item;\n    };\n\n    const setColsStyle = (item:FormItem) => {\n      let style = {};\n      if (item.col && cols) {\n        // 如果是inline并且没有传递列数，才需设置宽度\n        const width = `${+(100 / currentCols.value).toFixed(1) * +item.col}%`;\n        style = {\n          width,\n          paddingRight: _gutter,\n        };\n      }\n      return { ...item, style: { ...style, ...item.style } };\n    };\n\n    const setOptions = (item:FormItem) => {\n      const { type, optionsUrl } = item;\n      if (!['select', 'checkbox', 'radio'].includes(type!)) return item;\n      if (!optionsUrl) return item;\n      return item;\n    };\n\n    const chainHanlder = (_data:FormItem, fns:Function[] = []) => {\n      return fns.reduce((memo, cur) => cur(memo), _data);\n    };\n\n    // 对传进来的data进行处理\n    const handleData = () => {\n      state.currentData = props.data.filter(item => item.show !== false).map(item => {\n        const handlers = [setDefaultAttrs, setColsStyle, setOptions];\n        return chainHanlder(item, handlers);\n      });\n    };\n\n    // 根据传进来的数据，生成双向绑定的初始对象\n    const _resetParams = () => {\n      state.params = resetParams(state.currentData);\n    };\n\n    // 验证--用于外部调用\n    const formCheck = () => {\n      let pass;\n      refs.form.validate((valid:boolean) => {\n        pass = valid;\n      });\n      return pass;\n    };\n\n    // 清除验证--用于外部调用\n    const clearCheck = () => {\n      // 必须使用nextTick保证在弹窗出现后执行\n      root.$nextTick(() => {\n        refs.form.clearValidate();\n      });\n    };\n\n    watch(() => props.data, (val, oldVal) => {\n      handleData();\n      _resetParams();\n    }, {\n      immediate: true,\n    });\n\n    // onMounted(() => {\n    //   handleData();\n    //   _resetParams();\n    // });\n\n    return {\n      ...toRefs(state),\n      setDefaultAttrs,\n      setColsStyle,\n      setOptions,\n      handleData,\n      formCheck,\n      clearCheck,\n\n    };\n  },\n  render() {\n    const {\n      $attrs, currentData, params, formItemStyle, formStyle, $scopedSlots, $slots, formItemProps: publicFormItemProps, labelPosition, showInlineTitle,\n    } = this;\n    const getFormItem = (itemOptions:FormItem) => {\n      // 这里没用到的不能剔除，因为需要把它们从otherProps里面剔除\n      const {\n        key,\n        type,\n        childType,\n        options = [],\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        title,\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        rules,\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        formItemProps,\n        on,\n        nativeOn,\n        ...otherProps\n      } = itemOptions;\n      const scopedTag = $scopedSlots[key];\n      if (scopedTag) return scopedTag(itemOptions);\n\n      const dynamicProps = { attrs: otherProps, on, nativeOn };\n\n      const getOptions = () => options.map(({ key: optionKey, title: optionTitle, ...optionProps }) => {\n        const optionAttrs = {\n          key: optionKey,\n          ...optionProps,\n        };\n        switch (type) {\n          case 'select':\n          default:\n            return <el-option label={optionTitle} value={optionKey} {...{ attrs: optionAttrs }}></el-option>;\n          case 'checkbox':\n            return (\n                <el-checkbox label={optionKey} {...{ attrs: optionAttrs }}>\n                  {optionTitle}\n                </el-checkbox>\n            );\n          case 'radio':\n            return (\n                <el-radio label={optionKey} {...{ attrs: optionAttrs }}>\n                  {optionTitle}\n                </el-radio>\n            );\n        }\n      });\n\n      switch (type) {\n        case 'input':\n        default:\n          return <el-input vModel={params[key]} type={childType} {...dynamicProps} ></el-input>;\n        case 'select':\n          return (\n            <el-select vModel={params[key]} {...dynamicProps}>\n              {getOptions()}\n            </el-select>\n          );\n        case 'checkbox':\n          return (\n            <el-checkbox-group vModel={params[key]} {...dynamicProps}>\n              {getOptions()}\n            </el-checkbox-group>\n          );\n        case 'radio':\n          return (\n            <el-radio-group vModel={params[key]} {...dynamicProps}>\n              {getOptions()}\n            </el-radio-group>\n          );\n        case 'date':\n          return <el-date-picker vModel={params[key]} type={childType} {...dynamicProps}></el-date-picker>;\n        case 'time':\n          return <el-time-picker vModel={params[key]} {...dynamicProps}></el-time-picker>;\n        case 'switch':\n          return <el-switch vModel={params[key]} {...dynamicProps}></el-switch>;\n        case 'block':\n          return '';\n      }\n    };\n\n    return (\n      <el-form\n        label-width={$attrs.inline === '' && !showInlineTitle ? '0' : $attrs['label-width'] || '80'}\n        size={$attrs.size || 'small'}\n        class=\"h-form\"\n        style={formStyle}\n        {...{ attrs: { ...$attrs, model: params } }}\n        onSubmit_prevent\n        ref=\"form\"\n      >\n      <div class=\"h-form-left\">\n          {currentData.map(itemOptions => {\n            const {\n              key, title, rules, formItemProps = {},\n            } = itemOptions;\n            const { class: formItemClass, style: _formItemStyle, ...otherFormItemProps } = formItemProps;\n            return (\n              <el-form-item\n                key={key}\n                prop={key}\n                label={$attrs.inline === '' && !showInlineTitle ? '' : title}\n                rules={rules}\n                class={['h-form-item', { 'label-top': labelPosition === 'top' }, formItemClass]}\n                style={{ ...formItemStyle, ..._formItemStyle }}\n                {...{ attrs: { ...otherFormItemProps, ...publicFormItemProps } }}\n\n              >\n                {getFormItem(itemOptions)}\n              </el-form-item>\n            );\n          })}\n          {$slots.default || null}\n        </div>\n\n        {\n          $slots.right && <div class=\"h-form-right\">\n            {$slots.right}\n          </div>\n        }\n\n      </el-form>\n    );\n  },\n});\n\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=tsx&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=tsx&\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HModal.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}