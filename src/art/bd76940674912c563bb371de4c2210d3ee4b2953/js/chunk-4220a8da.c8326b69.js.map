{"version":3,"sources":["webpack:///./node_modules/@4dst-saas/public-utils/dist/composables/use-loader.js","webpack:///./src/components/MaterialTypeCascade.vue?cd35","webpack:///./src/components/MaterialTypeCascade.vue?16f2","webpack:///./src/components/MaterialTypeCascade.vue?3409","webpack:///./src/components/MaterialTypeCascade.vue","webpack:///./node_modules/@4dst-saas/public-utils/dist/difference.js","webpack:///./src/utils/i18n-material-type.ts","webpack:///./src/loaders/supplier.ts","webpack:///./src/components/anta-customer-files/customJsonschema.ts","webpack:///./src/components/anta-customer-files/attribute.ts"],"names":["_interopRequireDefault","Object","defineProperty","exports","value","default","_regenerator","_asyncToGenerator2","_defineProperty2","_compositionApi","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defaultOptions","initialValue","undefined","loadingValue","oldValue","useLoader","loader","oldWatcher","params","_ref","_ref$initialValue","_ref$loadingValue","r","reactive","watchSource","resultRef","ref","tmp","that","getCurrentInstance","loaderPromiseRef","$on","mark","_callee2","wrap","_context2","prev","next","watch","_ref3","_callee","_loaderPromiseRef","_context","sent","stop","_x","this","immediate","s","_ref4","_callee3","_tmp","_context3","isRef","__tmp","_x2","_default","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","list","showClearable","disabled","$t","cascaderProps","on","handleChange","scopedSlots","_u","fn","data","_v","_s","label","staticRenderFns","model","prop","event","props","strictMode","type","Boolean","maxLevel","Number","Array","required","checkStrictly","expandTrigger","String","businessType","setup","emit","selected","cascader","getChildren","id","level","map","leaf","subCount","name","initOptionList","children","result","item","find","j","checkedNodes","nodes","getCheckedNodes","pathNodes","n","lazy","lazyLoad","node","resolve","res","defaultList","ids","v","component","difference","a","b","aItem","findIndex","bItem","indexOf","include","translateCategoryName","categoryName","t","fetchSupplierAll","method","url","fetchSupplierNotBound","title","builder","sort","class","properties","toFixed","unit","oneOf","const","clearable","getCategoryName","axios","fetchSupplierName","originalSupplierName","attribute2JSONschema","itemOrList","prototype","toString","call","JSONschemaList","attr","isSystem","obj","customJsonschema","isArray","values","av","$id","valueKey","labelKey","validator","anyOf","JSONschemaList2JSONschema","useSort","wrapper","reduce","pre","cur","antaMiddleClassIdAndFormData2TransformedFormDataList","middleClassId","formData","setColorLimitType","colorLimitType","extractList","propertiesSortList","Math","abs","Promise","all","propertyItem","propertyId","year","season","referenceUnit","reference_price","costUnit","cost","Error","wait4FetchValue","notFounds","labels","concat","join","l","jsonschema2FormItemValidatorObject","jss","validatorObject","validatorKeys","includes","valueList","console","log"],"mappings":"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","file":"js/chunk-4220a8da.c8326b69.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _compositionApi = require(\"@vue/composition-api\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar defaultOptions = {\n  initialValue: undefined,\n  loadingValue: function loadingValue(oldValue) {\n    return oldValue;\n  }\n};\n\nfunction useLoader(loader) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultOptions,\n      _ref$initialValue = _ref.initialValue,\n      initialValue = _ref$initialValue === void 0 ? defaultOptions.initialValue : _ref$initialValue,\n      _ref$loadingValue = _ref.loadingValue,\n      loadingValue = _ref$loadingValue === void 0 ? defaultOptions.loadingValue : _ref$loadingValue;\n\n  var r = (0, _compositionApi.reactive)(params);\n\n  var watchSource = function watchSource() {\n    return _objectSpread({}, r);\n  };\n\n  var resultRef = (0, _compositionApi.ref)(initialValue);\n  var tmp = (0, _compositionApi.ref)(null);\n  var that = (0, _compositionApi.getCurrentInstance)();\n  var loaderPromiseRef = (0, _compositionApi.ref)();\n  if (!that) return;\n  that.$on('hook:created', /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n    return _regenerator.default.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            loaderPromiseRef.value = loader(watchSource());\n            (0, _compositionApi.watch)(loaderPromiseRef, /*#__PURE__*/function () {\n              var _ref3 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(_loaderPromiseRef) {\n                return _regenerator.default.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        resultRef.value = loadingValue(resultRef.value);\n                        _context.next = 3;\n                        return _loaderPromiseRef;\n\n                      case 3:\n                        tmp.value = _context.sent;\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n\n              return function (_x) {\n                return _ref3.apply(this, arguments);\n              };\n            }(), {\n              immediate: true\n            });\n            _context2.next = 4;\n            return loaderPromiseRef.value;\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })));\n  var oldWatcher;\n  (0, _compositionApi.watch)(watchSource, function (s) {\n    if (oldWatcher) {\n      oldWatcher();\n    }\n\n    loaderPromiseRef.value = loader(s);\n  });\n  (0, _compositionApi.watch)(tmp, /*#__PURE__*/function () {\n    var _ref4 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(_tmp) {\n      return _regenerator.default.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if ((0, _compositionApi.isRef)(_tmp)) {\n                oldWatcher = (0, _compositionApi.watch)(_tmp, function (__tmp) {\n                  resultRef.value = __tmp;\n                }, {\n                  immediate: true\n                });\n              } else {\n                resultRef.value = _tmp;\n              }\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }()); // eslint-disable-next-line consistent-return\n\n  return resultRef;\n}\n\nvar _default = useLoader;\nexports.default = _default;","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-cascader',{ref:\"cascader\",staticClass:\"fixed-width anta\",attrs:{\"options\":_vm.list,\"value\":_vm.value,\"clearable\":_vm.showClearable,\"disabled\":_vm.disabled,\"placeholder\":_vm.$t('material.others.select_type'),\"props\":_vm.cascaderProps,\"size\":\"small\"},on:{\"change\":_vm.handleChange},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar data = ref.data;\nreturn [_c('span',[_vm._v(_vm._s(data.label))])]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport {\n  defineComponent, ref, watch, toRefs, computed,\n} from '@vue/composition-api';\nimport { fetchMaterialTypes } from '@/api/material';\nimport useLoader from '_/composables/use-loader';\nimport { ElCascader } from 'element-ui/types/cascader';\nimport translateCategoryName from '@/utils/i18n-material-type';\n\ntype MaterialSelectItem = {\n  id: string,\n  name: string,\n  label: string,\n  subCount?: number,\n  children?: MaterialSelectItem[]\n  parentIds?: string[]\n  leaf?: boolean,\n  disabled?: boolean,\n};\n\nexport default defineComponent({\n  model: {\n    prop: 'value',\n    event: 'change',\n  },\n  props: {\n    strictMode: {\n      type: Boolean,\n      default: false,\n    },\n    maxLevel: {\n      type: Number,\n      default: 2,\n    },\n    value: {\n      type: Array as () => string[],\n      required: true,\n      default: () => [],\n    },\n    checkStrictly: {\n      type: Boolean,\n      default: false,\n    },\n    expandTrigger: {\n      type: String,\n      default: 'click',\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n    showClearable: {\n      type: Boolean,\n      default: true,\n    },\n\n    businessType: {\n      // 1安踏 0普通\n      type: Number,\n      default: 1,\n    },\n  },\n  setup(props, { emit }) {\n    const selected = ref<MaterialSelectItem[]>([]);\n\n    const cascader = ref<ElCascader>();\n\n    async function getChildren(id: string, level: number) {\n      const list = (await fetchMaterialTypes(id, props.businessType)) as MaterialSelectItem[];\n      return list.map(i => {\n        i.leaf = !(i.subCount && i.subCount > 0 && level < props.maxLevel);\n        i.disabled = props.maxLevel !== level && !i.subCount && props.strictMode;\n        if (props.businessType === 0) {\n          i.label = translateCategoryName(i.name);\n        } else {\n          i.label = i.name;\n        }\n        return i;\n      });\n    }\n\n    async function initOptionList(children: MaterialSelectItem[], list: string[]) {\n      const result = [];\n      while (children && children.length) {\n        // eslint-disable-next-line no-loop-func\n        const item = children.find(j => j.id === list[result.length]);\n        if (item && result.length < props.maxLevel) {\n          result.push(item);\n          item.children = item.children || await getChildren(item.id, result.length);\n          ({ children } = item);\n        } else {\n          children = [];\n        }\n      }\n      return result;\n    }\n\n    const checkedNodes = computed(() => {\n      const nodes = cascader.value?.getCheckedNodes()[0]?.pathNodes?.map(n => {\n        return n.data;\n      }) || [];\n      return nodes;\n    });\n\n    const getCheckedNodes = () => {\n      const nodes = cascader.value?.getCheckedNodes()[0]?.pathNodes?.map(n => {\n        return n.data;\n      }) || [];\n      return nodes;\n    };\n\n    const cascaderProps = {\n      lazy: true,\n      label: 'label',\n      value: 'id',\n      children: 'children',\n      checkStrictly: props.checkStrictly,\n      expandTrigger: props.expandTrigger,\n      lazyLoad: async (node, resolve) => {\n        if (node.level && node.level < props.maxLevel + 1 && !node.leaf && node.children?.length === 0) {\n          const res = await getChildren(node.value, node.level);\n          resolve(res);\n        } else {\n          resolve();\n        }\n      },\n    };\n\n    const list = useLoader(async ({ value }) => {\n      const defaultList = await getChildren('-1', 0);\n      if (value.length) {\n        if (defaultList) {\n          selected.value = await initOptionList(defaultList, value);\n        }\n      }\n      return defaultList;\n    }, {\n      ...toRefs(props),\n    }, {\n      initialValue: [],\n    });\n\n    async function handleChange(ids: string[]) {\n      if (!cascader.value?.getCheckedNodes()[0]) {\n        emit('change', ids, []);\n      } else {\n        const nodes = cascader.value?.getCheckedNodes()[0]?.pathNodes?.map(n => {\n          return n.data;\n        }) || [];\n        emit('change', ids, nodes);\n      }\n    }\n\n    watch(() => checkedNodes.value, (v) => {\n      if (v.length > 0) handleChange(props.value);\n    });\n    // watch(() => {\n    //   return props.value;\n    // }, (v, ov) => {\n    //   if (JSON.stringify(v) !== JSON.stringify(ov)) {\n    //     if (v.length > 0) {\n    //\n    //       initOptionList(list.value, v);\n    //     } else {\n    //\n    //\n    //     }\n    //   }\n    // });\n\n    return {\n      cascaderProps,\n      handleChange,\n      list,\n      cascader,\n      getCheckedNodes,\n      checkedNodes,\n    };\n  },\n\n});\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MaterialTypeCascade.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MaterialTypeCascade.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MaterialTypeCascade.vue?vue&type=template&id=bb4c346e&\"\nimport script from \"./MaterialTypeCascade.vue?vue&type=script&lang=ts&\"\nexport * from \"./MaterialTypeCascade.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\"use strict\";\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.find-index\");\n\nrequire(\"core-js/modules/es.array.index-of\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.difference = difference;\nexports.default = void 0;\n\n/**\n * 得出b相对于a补集（a里边找b没有的）\n * @see https://zh.wikipedia.org/wiki/%E8%A1%A5%E9%9B%86\n * @param a数组\n * @param b数组\n * @param fn 用于对比的方法\n */\nfunction difference(a, b, fn) {\n  return a.filter(function (aItem) {\n    var i = fn ? b.findIndex(function (bItem) {\n      return fn(aItem, bItem);\n    }) : b.indexOf(aItem);\n    var include = i === -1;\n    return include;\n  });\n}\n\nvar _default = difference;\nexports.default = _default;","import i18n from 'i18next';\n\nexport default function translateCategoryName(categoryName: string) {\n  return i18n.t(`material.material-category.${categoryName}`);\n}\n","import axios from '@/utils/axios';\n\nexport async function fetchSupplierList() {\n  const res = (await axios({\n    method: 'post',\n    url: '/anta-material/supplier/list/condition',\n    data: {\n      status: '1',\n    },\n  })).data;\n  return res;\n}\n\nexport async function fetchSupplierAll() {\n  const res = (await axios({\n    method: 'post',\n    url: '/anta-material/supplier/list/condition',\n    data: {},\n  })).data;\n  return res;\n}\n\nexport async function fetchSupplierNotBound() {\n  const res = (await axios({\n    method: 'get',\n    url: '/anta-material/supplier/searchOriginalSupplierNameByNotBound',\n  })).data;\n  return res;\n}\n\nexport default fetchSupplierNotBound;\n","import Jsonschema from '@4dst-saas/form-utils/dist/components/jsonschema2form/JSONschema';\n\nconst list : Jsonschema[] = [{\n  prop: 'materialName',\n  title: '材料名称',\n  type: 'string',\n  required: true,\n}, {\n  prop: 'season',\n  type: 'string',\n  title: '季节',\n  builder: 'SeasonSelect',\n  required: [],\n}, {\n  prop: 'material_number',\n  type: 'string',\n  disabled: true,\n  title: '材料编码',\n}, {\n  prop: 'category',\n  type: 'string',\n  title: '选择分类',\n  builder: 'MaterialTypeCascade',\n  required: [],\n  attrs: {\n    strictMode: true,\n  },\n}, {\n  prop: 'supplier_name',\n  type: 'string',\n  title: '供应商名称',\n  builder: 'SupplierSelect',\n  // required: [],\n}, {\n  prop: 'reference_price',\n  type: 'object',\n  title: '参考单价',\n  // required: ['value'],\n  // builder: 'PriceFormItem',\n  // attrs: {\n  //   toFixed: 3,\n  // },\n  sort: ['value', 'unit'],\n  class: 'price-item',\n  properties: {\n    value: {\n      type: 'number',\n      prop: 'value',\n      // builder: 'PriceFormItem',\n      // required: [],\n      toFixed: 3,\n    },\n    unit: {\n      type: 'string',\n      prop: 'unit',\n      oneOf: [\n        {\n          type: 'integer',\n          const: {\n            label: '人民币',\n            value: 1,\n          },\n        }, {\n          type: 'integer',\n          const: {\n            label: '美元',\n            value: 2,\n          },\n        },\n      ],\n    },\n  },\n}, {\n  prop: 'cost',\n  type: 'string',\n  title: '成本单价',\n}, {\n  prop: 'color_limit_type',\n  type: 'string',\n  title: '颜色限制类别',\n  clearable: true,\n  oneOf: [\n    {\n      type: 'integer',\n      const: {\n        label: '全部颜色',\n        value: 1,\n      },\n    }, {\n      type: 'integer',\n      const: {\n        label: '仅部分颜色',\n        value: 2,\n      },\n    }, {\n      type: 'integer',\n      const: {\n        label: '荧光色除外',\n        value: 3,\n      },\n    },\n  ],\n}, {\n  prop: 'evergreen',\n  type: 'string',\n  title: '常青材料',\n  builder: 'el-checkbox',\n  attrs: {\n    'true-label': 1,\n    'false-label': 2,\n    label: 'TRUE',\n  },\n}];\n\nexport default list;\n","import Jsonschema from '@4dst-saas/form-utils/dist/components/jsonschema2form/JSONschema';\nimport axios from '@/utils/axios';\nimport { fetchAntaPropertyById } from '@/loaders/dictionary';\nimport difference from '@4dst-saas/public-utils/dist/difference';\nimport customJsonschemaList from './customJsonschema';\n\n\n// 获取大中小类组合的类名\nasync function getCategoryName(id: string) {\n  return ((await axios({\n    method: 'post',\n    url: '/anta-material/category/name',\n    data: {\n      ids: [id],\n    },\n  })).data)[id];\n}\n\n// 获取供应商名称\nasync function fetchSupplierName(id: string) {\n  const res = (await axios({\n    method: 'post',\n    url: '/anta-material/supplier/list/condition',\n    data: { ids: [id] },\n  })).data;\n  return res?.[0]?.originalSupplierName || '';\n}\n\nexport type IAttribute = {\n  id?: string,\n  title: string,\n  required: boolean | 0 | 1,\n  values?: IOption[] | undefined,\n  key: string,\n  isSystem?: boolean,\n  component: 1 | 2 | 3 /** 小数、整数、文本是1，下拉类型是2 */,\n  params?: Partial<Jsonschema>,\n};\n\nexport type IOption = {\n  id?: string,\n  label: string,\n  sort: number,\n};\n\nexport function attributeValueExtractFEId(list: IAttribute['values']) {\n  if (!list) return list;\n  return list.map((item) => {\n    const { id, label, sort } = item;\n    if (id?.startsWith('@FE')) {\n      return {\n        label, sort,\n      };\n    }\n    return { id, label, sort };\n  });\n}\n\nexport function attribute2JSONschema(itemOrList: IAttribute | IAttribute[] | {isSystem: true, key: string, title: string}) {\n  const list = (\n    Object.prototype.toString.call(itemOrList) === '[object Array]' ? itemOrList : [itemOrList]\n  ) as IAttribute[];\n  const JSONschemaList = list.map(attr => {\n    if (attr.isSystem) {\n      const obj = {\n        ...customJsonschemaList.find(item => {\n          return item.prop === attr.key;\n        }),\n      };\n\n      obj.required = obj.type === 'object' ? (\n        attr.required ? Object.keys(obj.properties) : []\n      ) : !!attr.required;\n\n      if (Array.isArray(obj.required) && !obj.required.length) {\n        delete obj.required;\n      }\n      return obj;\n    }\n    if (!attr.params) {\n      attr.params = new Jsonschema({ type: 'string' });\n    }\n    // 增加title\n    attr.params = {\n      ...attr.params,\n      title: attr.title,\n    };\n    if (attr.key) {\n      attr.params.prop = attr.key;\n    }\n    if (attr.required) attr.params.required = [];\n    switch (attr.component) {\n      case 1: return { ...attr.params! } as Jsonschema;\n      case 2: {\n        const oneOf = attr.values!.map(av => new Jsonschema({\n          type: 'string',\n          const: {\n            label: av.label,\n            value: av.id!,\n          } as unknown as 'object',\n          $id: av.id!,\n        }));\n        attr.params = {\n          ...attr.params,\n          oneOf,\n          valueKey: 'value',\n          labelKey: 'label',\n          validator: [attr.title],\n        };\n        return ({ ...attr.params!, oneOf }) as Jsonschema;\n      }\n      case 3: {\n        const anyOf = attr.values!.map(av => new Jsonschema({\n          type: 'string',\n          const: {\n            label: av.label,\n            value: av.id!,\n          } as unknown as 'object',\n          $id: av.id!,\n        }));\n        attr.params = {\n          ...attr.params,\n          // oneOf,\n          valueKey: 'value',\n          labelKey: 'label',\n          validator: [attr.title],\n          type: 'array',\n          anyOf,\n        };\n        return ({ ...attr.params! }) as Jsonschema;\n      }\n      default: return new Jsonschema({ type: 'string' });\n    }\n  });\n  return list.length > 1 ? JSONschemaList : JSONschemaList[0];\n}\n\n/** 将输入的JSONschema数组包成一个JSONschema (弃用) */\nexport function JSONschemaList2JSONschema(list: Jsonschema[], useSort = true): Jsonschema {\n  const wrapper = new Jsonschema({ type: 'object', properties: {} });\n  wrapper.properties = {\n    ...list.reduce((pre, cur) => ({\n      ...pre,\n      [cur.title!]: cur,\n    }), {}),\n  };\n  wrapper.required = [...(list.filter(item => item.required).map(item => item.title) as string[])];\n  if (useSort) {\n    wrapper.sort = list.map(item => item.title!);\n  }\n  return wrapper;\n}\n\n/**\n * 用于面料详情显示\n * 输入中类id和formData，返回转换好的formData\n *\n * @param extractList 根据权限需要去掉的属性\n */\nexport async function antaMiddleClassIdAndFormData2TransformedFormDataList(\n  middleClassId: string,\n  formData: {[key: string]: string | number| object},\n  extractList: string[] = [],\n) {\n  const properties = (await axios({\n    url: '/anta-material/template/middle',\n    params: { id: middleClassId },\n    method: 'GET',\n  })).data as { propertyId?: string, sort: number, isSystem: boolean, title: string, key: string }[];\n\n  if (!properties.length) return formData;\n\n  // 排序\n  const propertiesSortList = properties.sort(\n    (a, b) => Math.abs(a.sort) - Math.abs(b.sort),\n  );\n\n  // 处理一下\n  const list = (await Promise.all(propertiesSortList.map(async (propertyItem) => {\n    if (propertyItem.isSystem) {\n      return propertyItem;\n    }\n    return (await axios({\n      url: `/anta-material/dynamics/property/detail?id=${propertyItem.propertyId}`, method: 'GET',\n    })).data as IAttribute;\n  }))).filter(i => extractList.indexOf(i.title) === -1);\n\n\n  function setColorLimitType(colorLimitType : 1 | 2 | 3 | undefined) {\n    switch (colorLimitType) {\n      case 1: return '全部颜色';\n      case 2: return '仅部分颜色';\n      case 3: return '荧光色除外';\n      default: return '--';\n    }\n  }\n\n  // 将值转为对应显示的东西\n  const l = await Promise.all(list.map(async (item) => {\n    if (item.isSystem) {\n      switch (item.key) {\n        case 'category': return { label: item.title, value: await getCategoryName(formData[item.key] as string) };\n        case 'season': return {\n          label: item.title,\n          value: formData[item.key]\n            ? `${formData[item.key].year || ''}${formData[item.key].season || ''}${await fetchAntaPropertyById(formData[item.key]['品牌'])}`\n            : '--',\n        };\n        case 'reference_price': {\n          const referenceUnit = formData.reference_price.unit === 1 ? '人民币' : '美元';\n          return { label: item.title, value: formData[item.key].value ? `${formData[item.key].value}${referenceUnit}` : '--' };\n        }\n        case 'cost': {\n          const costUnit = formData.cost.unit === 1 ? '人民币' : '美元';\n          return { label: item.title, value: formData[item.key].value ? `${formData[item.key].value}${costUnit}` : '--' };\n        }\n        case 'color_limit_type': return { label: item.title, value: setColorLimitType(formData[item.key] as 1 | 2 | 3) };\n        case 'evergreen': return { label: item.title, value: formData[item.key] === 1 ? 'TRUE' : 'FALSE' };\n        case 'supplier_name': return { label: item.title, value: await fetchSupplierName(formData[item.key] as string) };\n        case 'materialName':\n        case 'material_number': return { label: item.title, value: formData[item.key] };\n        // default: throw new Error(`数据转换出错。当前key为${item.key}`);\n        default: throw new Error(`数据转换出错。当前title为${item.title}`);\n      }\n    }\n\n    // 非系统属性\n    switch (item.component) {\n      case 1: return { label: item.title, value: formData[item.title] };\n      // case 3: return { label: item.title, value: formData[item.id!] };\n      case 2: {\n        // 先判断是否在可选值中。如果在可选值中，直接获取可选值，否则还要根据id调接口获得\n        const wait4FetchValue = formData[item.title] as string;\n        const target = item.values!.find(i => i.id === wait4FetchValue);\n        if (target) return { label: item.title, value: target.label };\n        const label = (await axios({\n          url: '/anta-material/dynamics/property/value/id',\n          method: 'GET',\n          params: { id: wait4FetchValue },\n        })).data as string;\n        return { label: item.title, value: label };\n      }\n      case 3: {\n        const wait4FetchValue = formData[item.title] as string[] || [];\n        const notFounds = wait4FetchValue.filter(v => !item.values!.find(i => i.id === v));\n        // if (!notFounds.length) return { label: item.title, value: targets.join(',') };\n        const labels = await Promise.all(notFounds.map(async (id) => (await axios({\n          url: '/anta-material/dynamics/property/value/id',\n          method: 'GET',\n          params: { id },\n        })).data as string));\n        const res = labels.concat(\n          difference(wait4FetchValue, notFounds).map(\n            v => item.values.find(i => i.id === v)?.label,\n          ),\n        ).join(',');\n        // return res;\n        return { label: item.title, value: res };\n      }\n      default: throw new Error(`数据转换出错。当前component为${item.component}`);\n    }\n  }));\n  return l;\n}\n\n/** 输入中类id和formData，返回转换好的formData(弃用) */\nexport async function antaMiddleClassIdAndFormData2TransformedFormData(\n  middleClassId: string,\n  formData: {[key: string]: string | number},\n) {\n  const properties = (await axios({\n    url: '/anta-material/template/middle',\n    params: { id: middleClassId },\n    method: 'GET',\n  })).data as { propertyId: string }[];\n  if (!properties.length) return formData;\n  const pIds = properties.map(property => property.propertyId);\n\n  const list = await Promise.all(pIds.map(async (id) => {\n    return (await axios({\n      url: `/anta-material/dynamics/property/detail?id=${id}`, method: 'GET',\n    })).data as IAttribute;\n  }));\n  const res = { ...formData };\n  const filterList = list.filter(attr => attr.component === 2);\n  const shouldFetchList:{key: string, id: string}[] = [];\n  filterList.forEach(item => {\n    const key = item.title;\n    const wait4FetchValue = formData[key] as string;\n    const target = item.values!.find(i => i.id === wait4FetchValue);\n    // 找到了\n    if (target) res[key] = target.label;\n    else shouldFetchList.push({ key, id: wait4FetchValue });\n  });\n  if (shouldFetchList.length) {\n    await Promise.all(shouldFetchList.map(async ({ id, key }) => {\n      const value = (await axios({\n        url: '/anta-material/dynamics/property/value/id',\n        method: 'GET',\n        params: { id },\n      })).data as string;\n      console.log(value);\n      res[key] = value;\n    }));\n  }\n  return res;\n}\n\n/** 输入jsonschema，返回包含检验下拉框值的validator函数组成的对象 */\nexport function jsonschema2FormItemValidatorObject(jss: Jsonschema) {\n  if (jss.type !== 'object') throw new Error('输入的jsonschema不是object类型');\n  if (!jss.properties) throw new Error('输入的jsonschema没有properties');\n  const validatorObject:{[key: string]: Function} = {};\n  const validatorKeys = Object.keys(jss.properties!).filter(key => jss.properties![key].oneOf);\n  validatorKeys.forEach(key => {\n    if (jss.properties![key].type === 'array') return;\n    if (jss.required?.includes(key) || jss.properties![key].required\n    || (typeof (jss.properties![key].disabled) === 'boolean' && !jss.properties![key].disabled)) {\n      validatorObject[key] = (value: string) => {\n        const valueList = (jss.properties![key].oneOf!.map(item => item.const! as unknown as {\n          label: string, value: string,\n        })).map(({ value: _v }) => _v);\n        console.log(valueList);\n        if (!valueList.includes(value)) throw new Error('此值已被删除');\n      };\n    }\n  });\n  return validatorObject;\n}\n"],"sourceRoot":""}