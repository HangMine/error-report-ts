{"version":3,"sources":["webpack:///./node_modules/@4dst-saas/public-utils/dist/composables/use-loader.js","webpack:///./src/views/test/TagsEditor.tsx","webpack:///./src/views/test/ClothesDetail.vue?d622","webpack:///./src/views/test/ClothesDetail.vue?9a18","webpack:///./src/components/dynamic-form/jsonschema2form/NumberType.tsx","webpack:///./src/views/test/ClothesDetail.vue","webpack:///./src/views/test/ClothesDetail.vue?a490"],"names":["_interopRequireDefault","Object","defineProperty","exports","value","default","_regenerator","_asyncToGenerator2","_defineProperty2","_compositionApi","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defaultOptions","initialValue","undefined","loadingValue","oldValue","useLoader","loader","oldWatcher","params","_ref","_ref$initialValue","_ref$loadingValue","r","reactive","watchSource","resultRef","ref","tmp","that","getCurrentInstance","loaderPromiseRef","$on","mark","_callee2","wrap","_context2","prev","next","watch","_ref3","_callee","_loaderPromiseRef","_context","sent","stop","_x","this","immediate","s","_ref4","_callee3","_tmp","_context3","isRef","__tmp","_x2","_default","tagsEditor","props","tags","type","Array","editable","Boolean","required","shareId","String","relateType","render","flexWrap","map","tagItem","border","marginRight","fontSize","lineHeight","padding","borderRadius","marginBottom","color","tag","cursor","marginLeft","handleDeleteTag","useLabel","width","height","handleAddTag","label","setup","deleteTag","data","url","method","addTag","res","id","splice","indexOf","IMode","numberType","builder","val","Number","toFixed","max","Infinity","min","disabled","model","prop","event","parsedValue","handleUpdateValue","e","$emit","emit","hasDot","includes","updateParsedValue","newStr","leng","short","lastIndexOf","test","globalThis","isNaN","preProcess","price","getClothesDetailInfo","clothingId","axios","getMaterialsInfo","modelId","headers","getPatternsInfo","patterns","item","decals","additionalJsonExt","decalInfo","additionalJson","decal","from","Set","Promise","all","pattern","imgUrl","patternUrls","staticRenderFns","rules","modelNumber","synopsis","Error","cDetail","dialogify","title","closeWith","components","BaseImage","isDialog","detailInfo","viewMode","editMode","tagsInfo","selectOptions","find","itemValue","priceOptions","priceUnit","wordBreak","filteredMaterialInfo","materialName","imgJson","flat","patternsInfo","oldInfo","JSON","parse","stringify","mode","edit","alignItems","option","itemCode","flex","view","handleAfterEdit","call","materialInfo","hash","language","typeCode","getEditableProperties","t","curtailImg","detailForm","component"],"mappings":"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","file":"js/chunk-76093ca4.e81813d0.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.array.filter\");\n\nrequire(\"core-js/modules/es.array.for-each\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _compositionApi = require(\"@vue/composition-api\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar defaultOptions = {\n  initialValue: undefined,\n  loadingValue: function loadingValue(oldValue) {\n    return oldValue;\n  }\n};\n\nfunction useLoader(loader) {\n  var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultOptions,\n      _ref$initialValue = _ref.initialValue,\n      initialValue = _ref$initialValue === void 0 ? defaultOptions.initialValue : _ref$initialValue,\n      _ref$loadingValue = _ref.loadingValue,\n      loadingValue = _ref$loadingValue === void 0 ? defaultOptions.loadingValue : _ref$loadingValue;\n\n  var r = (0, _compositionApi.reactive)(params);\n\n  var watchSource = function watchSource() {\n    return _objectSpread({}, r);\n  };\n\n  var resultRef = (0, _compositionApi.ref)(initialValue);\n  var tmp = (0, _compositionApi.ref)(null);\n  var that = (0, _compositionApi.getCurrentInstance)();\n  var loaderPromiseRef = (0, _compositionApi.ref)();\n  if (!that) return;\n  that.$on('hook:created', /*#__PURE__*/(0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n    return _regenerator.default.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            loaderPromiseRef.value = loader(watchSource());\n            (0, _compositionApi.watch)(loaderPromiseRef, /*#__PURE__*/function () {\n              var _ref3 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(_loaderPromiseRef) {\n                return _regenerator.default.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        resultRef.value = loadingValue(resultRef.value);\n                        _context.next = 3;\n                        return _loaderPromiseRef;\n\n                      case 3:\n                        tmp.value = _context.sent;\n\n                      case 4:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee);\n              }));\n\n              return function (_x) {\n                return _ref3.apply(this, arguments);\n              };\n            }(), {\n              immediate: true\n            });\n            _context2.next = 4;\n            return loaderPromiseRef.value;\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })));\n  var oldWatcher;\n  (0, _compositionApi.watch)(watchSource, function (s) {\n    if (oldWatcher) {\n      oldWatcher();\n    }\n\n    loaderPromiseRef.value = loader(s);\n  });\n  (0, _compositionApi.watch)(tmp, /*#__PURE__*/function () {\n    var _ref4 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(_tmp) {\n      return _regenerator.default.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if ((0, _compositionApi.isRef)(_tmp)) {\n                oldWatcher = (0, _compositionApi.watch)(_tmp, function (__tmp) {\n                  resultRef.value = __tmp;\n                }, {\n                  immediate: true\n                });\n              } else {\n                resultRef.value = _tmp;\n              }\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }()); // eslint-disable-next-line consistent-return\n\n  return resultRef;\n}\n\nvar _default = useLoader;\nexports.default = _default;","import axios from '@/utils/axios';\nimport { defineComponent, ref } from '@vue/composition-api';\n\ntype Tag = {\n  id: string;\n  tag: string;\n};\n\nconst tagsEditor = defineComponent({\n  props: {\n    tags: {\n      type: Array as () => Tag[],\n      default: () => [],\n    },\n    editable: {\n      type: Boolean,\n      default: true,\n      required: false,\n    },\n    shareId: {\n      type: String,\n      required: true,\n    },\n    type: {\n      type: String,\n      default: '1',\n    },\n    relateType: {\n      type: String,\n      default: '1',\n    },\n  },\n  render() {\n    const s = this as InstanceType<typeof tagsEditor>;\n    return <div class=\"flex\" style={{\n      flexWrap: 'wrap',\n    }}>\n      {\n        s.tags.map(tagItem => <div style={{\n          border: '1px solid #dbdbdb',\n          marginRight: '4px',\n          fontSize: '12px',\n          lineHeight: '18px',\n          padding: '3px 12px',\n          borderRadius: '12px',\n          marginBottom: '4px',\n          color: '#666',\n        }}>\n          <span>{tagItem.tag}</span>\n\n          <i vShow={s.editable} class='el-icon-close' style={{\n            cursor: 'pointer',\n            marginLeft: '4px',\n          }} onclick={() => { s.handleDeleteTag(tagItem); }}></i>\n        </div>)\n      }\n      <div class='flex-center' vShow={s.editable && !s.useLabel} style={{\n        width: '24px',\n        height: '24px',\n        border: '1px solid #dbdbdb',\n        cursor: 'pointer',\n        borderRadius: '12px',\n      }} onclick={() => { s.useLabel = true; }}>\n        <i class='el-icon-plus'></i>\n      </div>\n\n      <el-input vShow={s.editable && s.useLabel} vModel={s.label}\n      size='mini' onblur={s.handleAddTag} style={{\n        width: '200px',\n      }}></el-input>\n    </div>;\n  },\n  setup(props) {\n    const label = ref('');\n    const useLabel = ref(false);\n    async function deleteTag(data: string[]) {\n      await axios({\n        url: '/bff-center/showCommon/deleteTag',\n        method: 'POST',\n        data,\n      });\n    }\n    async function addTag(tags: string[]) {\n      const { shareId, type, relateType } = props;\n      return (await axios({\n        url: '/bff-center/showCommon/addTags',\n        method: 'POST',\n        data: {\n          shareId,\n          type,\n          relateType,\n          tags,\n        },\n      })).data;\n    }\n    async function handleAddTag() {\n      const res = await addTag([label.value]) as Tag[];\n      props.tags.push(...res);\n      label.value = '';\n      useLabel.value = false;\n    }\n    async function handleDeleteTag(tag: Tag) {\n      await deleteTag([tag.id]);\n      props.tags.splice(props.tags.indexOf(tag), 1);\n    }\n\n    return {\n      label,\n      useLabel,\n\n      handleAddTag,\n      handleDeleteTag,\n    };\n  },\n});\nexport default tagsEditor;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClothesDetail.vue?vue&type=style&index=0&id=6597be48&scoped=true&lang=scss&\"","\nimport {\n  defineComponent, ref, set, computed,\n} from '@vue/composition-api';\nimport useLoader from '_/composables/use-loader';\nimport axios from '@/api/axios';\nimport NumberType from '@/components/dynamic-form/jsonschema2form/NumberType';\nimport validator2ElemRule from '@/utils/validators/utils/validator-to-elem-rule';\nimport { validateForm } from '@/utils/validators/validate-form';\nimport { isFilled } from '@/utils/validators/is-filled';\nimport strLength from '@/utils/validators/str-length';\nimport {\n  normalizeRendererImgUrl, getRelativePathFromUrl,\n} from '@/utils/normalize-component';\n\nimport { DictItem } from '@/models/Dictionary';\nimport { ElForm } from 'element-ui/types/form';\nimport BaseImage from '@/components/base/Image.vue';\nimport TagsEditor from './TagsEditor';\n\ntype IClothesDetail = {\n  creator: string;\n  curtailImg: string;\n  gmtCreateTime: number;\n  gmtModifyTime: number;\n  id: string;\n  modelNumber: string;\n  modifier: string;\n  price: number;\n  priceUnit: string;\n  priceUnitObject: any;\n  stylistic: string;\n  synopsis: string;\n  tagsInfo: { id: string, tag: string }[];\n  type: number | string;\n  typeObject: any;\n};\n\ninterface IMaterialItem {\n  id: string,\n  materialName: string,\n  materialID: string,\n  renderArguments: string,\n  color: string,\n  supplierArticleName: string,\n  samplePrice: number,\n  samplePriceUnit: number,\n  supplierName: string,\n  imgJson: { [key: string]: string },\n}\n\ninterface CtmItem {\n  additionalJson: any,\n  additionalJsonExt: null | {\n    material?: Object, decalInfo?: Array<{\n      angle: number,\n      map: string,\n      position: number[],\n      rotation: number[],\n      scale: number,\n    }>\n  },\n  ctmId: string\n  ctmName: string\n  ctmPath: string\n  material: any\n  materialId: string\n  modelComponentId: string\n  modelFileId: string\n  modelId: string\n}\n\ninterface Hash {\n  [key: string]: any\n}\n\n// eslint-disable-next-line no-shadow\nenum IMode {\n  view,\n  edit\n}\n\nfunction preProcess(target: IClothesDetail) {\n  if (target.type === 0) {\n    target.type = '';\n  }\n  if (!target.price) {\n    set(target, 'price', '');\n  } else {\n    set(target, 'price', `${target.price}`);\n  }\n}\n\nasync function getClothesDetailInfo(clothingId: string) {\n  const res = (await axios({\n    method: 'GET',\n    url: '/bff-center/showCommon/clothingInfoSearch/getClothingInfoAndTags',\n    params: { clothingId },\n  })).data;\n  if (res) preProcess(res);\n  return res as IClothesDetail || null;\n}\n\nasync function getMaterialsInfo(modelId: string) {\n  const res = (await axios({\n    method: 'GET',\n    url: '/show/application/model/materials',\n    params: { modelId },\n    headers: {\n      'requester-type': 'web',\n      'model-type': 'CLOTHES',\n    },\n  })).data;\n  return res as IMaterialItem[] || null;\n}\n\nasync function getPatternsInfo(modelId: string) {\n  const res = (await axios({\n    method: 'GET',\n    url: '/show/application/model/ctms',\n    params: { modelId },\n    headers: {\n      'requester-type': 'web',\n      'model-type': 'CLOTHES',\n    },\n  })).data as CtmItem[];\n  let patterns: string[] = [];\n  res.forEach(item => {\n    const decals = item.additionalJsonExt?.decalInfo || item.additionalJson?.decalInfo;\n    if (decals) {\n      patterns.push(...(decals.map(decal => decal.map)));\n    }\n  });\n  patterns = Array.from(new Set(patterns));\n  const patternUrls = await Promise.all(patterns.map(async pattern => {\n    // let imgUrl = getRelativePathFromUrl(pattern);\n    const imgUrl = await normalizeRendererImgUrl(pattern);\n    return imgUrl;\n  }));\n  return patternUrls;\n}\n\nconst rules = {\n  modelNumber: validator2ElemRule((val: string) => {\n    isFilled(val);\n    strLength(val, {\n      min: 1, max: 32,\n    });\n  }),\n  type: validator2ElemRule(isFilled),\n  synopsis: validator2ElemRule((val: string) => {\n    if (val && val.length > 300) {\n      throw new Error('简介长度要小于300个字符');\n    }\n  }),\n  price: validator2ElemRule((val: string | number) => {\n    if (val && String(val).length > 8) {\n      throw new Error('请输入8位数以下的数字');\n    }\n  }),\n};\n\nconst cDetail = defineComponent({\n  dialogify: {\n    props: {\n      width: '600px',\n      title: '简介',\n    },\n    closeWith: 'detailInfo',\n  },\n  components: {\n    BaseImage,\n  },\n  props: {\n    clothingId: {\n      type: String,\n      required: true,\n    },\n    isDialog: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  render() {\n    const s = this as InstanceType<typeof cDetail>;\n    const { detailInfo } = s;\n\n    let viewMode = null;\n    let editMode = null;\n    if (detailInfo) {\n      viewMode = <div class='view-mode-container'>\n        <section class='item-container'>\n          <div class=\"item-title margin-bottom-8\">标签</div>\n\n          <div class='tags-container'>\n            {\n              detailInfo?.tagsInfo?.length > 0\n                ? <TagsEditor tags={s.detailInfo?.tagsInfo || []} type='4' relateType='4'\n                  key='view' shareId={s.clothingId} editable={false} />\n                : '- -'\n            }\n          </div>\n        </section>\n\n        <section class=\"item-container flex-column\">\n          <div class=\"item-title margin-bottom-8\">款式名称</div>\n\n          <div class=\"item-content\">{detailInfo!.modelNumber}</div>\n        </section>\n\n        <section class=\"item-container flex-column\">\n          <div class=\"item-title margin-bottom-8\">款式类型</div>\n\n          <div class=\"item-content\">{\n            s.selectOptions\n              ? s.selectOptions.find(i => i.itemValue === detailInfo?.type)?.label\n              : null\n          }</div>\n        </section>\n\n        <section class=\"item-container flex-column\">\n          <div class=\"item-title margin-bottom-8\">价格</div>\n\n          <div class=\"item-content\">{detailInfo!.price} {\n            s.priceOptions\n              ? s.priceOptions.find(i => i.itemValue === detailInfo?.priceUnit)?.label\n              : null\n          }</div>\n        </section>\n\n        <section class=\"item-container\">\n          <div class=\"item-title margin-bottom-8\">简介</div>\n\n          <div class=\"item-content item-info\" style={{\n            wordBreak: 'break-word',\n          }}>{detailInfo?.synopsis || '- -'}</div>\n        </section>\n\n        <section class=\"item-container\">\n          <div class=\"item-title margin-bottom-8\">面料</div>\n\n          {\n            s.filteredMaterialInfo\n              ? <ul class=\"materials\">\n                {\n                  s.filteredMaterialInfo.map(item => {\n                    return (\n                      <el-tooltip effect=\"dark\" content={item.materialName} placement=\"bottom\">\n                        <li class=\"material\">\n                          <img class=\"material-img\" src={item.imgJson.flat} />\n                        </li>\n                      </el-tooltip>\n                    );\n                  })\n                }\n              </ul>\n              : <div class=\"item-content\">- -</div>\n          }\n        </section>\n\n        <section class=\"item-container\">\n          <div class=\"item-title margin-bottom-8\">工艺图案</div>\n\n          {\n            s.patternsInfo\n              ? <ul class=\"materials\">\n                {\n                  s.patternsInfo.map(item => {\n                    return (\n                      <li class=\"material\">\n                        <BaseImage class=\"material-img\" src={item} fit=\"contain\" />\n                      </li>\n                    );\n                  })\n                }\n              </ul>\n              : <div class=\"item-content\">- -</div>\n          }\n        </section>\n\n        <footer\n          class={['flex-justify-flex-end', s.isDialog ? '' : 'detail-footer']}>\n          <el-button class=\"button-type\" type='primary' onclick={() => {\n            s.oldInfo = JSON.parse(JSON.stringify(s.detailInfo));\n            s.mode = IMode.edit;\n          }}>编辑</el-button>\n        </footer>\n      </div>;\n\n      editMode = <div class='edit-mode-container'>\n        <section class='item-container'>\n          <div class=\"item-title\">标签</div>\n\n          <div class='tags-container'>\n            {\n              <TagsEditor tags={s.detailInfo?.tagsInfo || []} type='4' relateType='4'\n                key='view' shareId={s.clothingId} editable={true} />\n            }\n          </div>\n        </section>\n\n        <el-form ref='detailForm' props={{ model: detailInfo }} rules={rules}>\n          <el-form-item class=\"item-title\" prop='modelNumber' label='款式名称'>\n            <el-input vModel={detailInfo!.modelNumber}></el-input>\n          </el-form-item>\n\n          <el-form-item class=\"flex-column\" prop='type' label='款式类型' style={{\n            alignItems: 'start',\n          }}>\n            <el-select vModel={detailInfo!.type}>\n              {\n                s.selectOptions.map(option => <el-option\n                  key={option.itemCode} value={option.itemValue}\n                  label={option.label}></el-option>)\n              }\n            </el-select>\n          </el-form-item>\n\n          {\n            <el-form-item class=\"flex-column content-width-100\" prop='price' label='价格' style={{\n              alignItems: 'start',\n            }}>\n              <div class=\"flex\">\n                <NumberType builder='el-input' style={{\n                  width: '70%',\n                }} max={99999999} vModel={detailInfo!.price}></NumberType>\n\n                <el-select style={{\n                  flex: 1,\n                }} vModel={detailInfo!.priceUnit}>\n                  {\n                    s.priceOptions.map(option => <el-option\n                      key={option.itemCode} value={option.itemValue}\n                      label={option.label}></el-option>)\n                  }\n                </el-select>\n              </div>\n            </el-form-item>\n          }\n\n          <el-form-item class=\"item-title\" prop='synopsis' label='简介'>\n            <el-input rows='5' type='textarea' maxlength='300'\n              vModel={detailInfo!.synopsis}></el-input>\n          </el-form-item>\n\n        </el-form>\n\n        <section class=\"item-container\">\n          <div class=\"item-title margin-bottom-8\">面料</div>\n          {\n            s.filteredMaterialInfo\n              ? <ul class=\"materials\">\n                {\n                  s.filteredMaterialInfo.map(item => {\n                    return (\n                      <el-tooltip effect=\"dark\" content={item.materialName} placement=\"bottom\">\n                        <li class=\"material\">\n                          <img class=\"material-img\" src={item.imgJson.flat} />\n                        </li>\n                      </el-tooltip>\n                    );\n                  })\n                }\n              </ul>\n              : <div class=\"item-content\">- -</div>\n          }\n        </section>\n\n        <section class=\"item-container\">\n          <div class=\"item-title margin-bottom-8\">工艺图案</div>\n\n          {\n            s.patternsInfo\n              ? <ul class=\"materials\">\n                {\n                  s.patternsInfo.map(item => {\n                    return (\n                      <li class=\"material\">\n                        <BaseImage class=\"material-img\" src={item} fit=\"contain\" />\n                      </li>\n                    );\n                  })\n                }\n              </ul>\n              : <div class=\"item-content\">- -</div>\n          }\n        </section>\n\n        <footer\n          class={['flex-justify-flex-end', s.isDialog ? '' : 'detail-footer']}>\n          <el-button class=\"button-type\" onclick={() => {\n            s.detailInfo = s.oldInfo!;\n            s.mode = IMode.view;\n          }}>取消</el-button>\n\n          <el-button class=\"button-type\" type='primary'\n            onclick={() => s.handleAfterEdit.call(s)}>确定</el-button>\n        </footer>\n      </div>;\n    }\n    return <section vLoading={!s.detailInfo}\n      class={['clothing-detail-container flex-column scrollable-y', s.isDialog ? '' : 'padding-20']}\n    >\n      {\n        <h3 class=\"clothing-detail-title\">简介</h3>\n      }\n      {\n        // eslint-disable-next-line\n        !detailInfo\n          // eslint-disable-next-line\n          ? null :\n          s.mode === IMode.view\n            ? viewMode\n            : editMode\n      }\n    </section>;\n  },\n  setup(props) {\n    const mode = ref(IMode.view);\n    const detailInfo = useLoader(async ({ clothingId }) => {\n      if (!clothingId) return null;\n      return getClothesDetailInfo(clothingId);\n    }, props, {\n      initialValue: null,\n    });\n    const oldInfo = ref<IClothesDetail>();\n\n\n    const materialInfo = useLoader(async ({ clothingId }) => {\n      if (!clothingId) return null;\n      return getMaterialsInfo(clothingId);\n    }, props, {\n      initialValue: null,\n    });\n\n    const patternsInfo = useLoader(async ({ clothingId }) => {\n      if (!clothingId) return null;\n      return getPatternsInfo(clothingId);\n    }, props, {\n      initialValue: null,\n    });\n\n    // 重复面料去重\n    const filteredMaterialInfo = computed(() => {\n      if (!materialInfo.value || materialInfo.value.length === 0) return [];\n      const hash: Hash = {};\n      return materialInfo.value!.filter(item => {\n        if (!hash[item.id]) {\n          hash[item.id] = item;\n          return true;\n        }\n        return false;\n      });\n    });\n\n    const selectOptions = useLoader(async () => {\n      const res = (await axios({\n        url: '/bff-center/showCommon/getDictionaryTypeItem',\n        headers: {\n          language: 'cn',\n        },\n        params: {\n          typeCode: 'clothingType',\n        },\n      })).data;\n      return res as DictItem[];\n    }, {}, {\n      initialValue: [],\n    });\n\n    // 去除不必变更的字段\n    function getEditableProperties(t = detailInfo.value) {\n      return {\n        ...t,\n        curtailImg: undefined,\n      };\n    }\n\n    const detailForm = ref<ElForm>();\n    async function handleAfterEdit() {\n      if (detailForm.value) {\n        await validateForm(detailForm.value);\n        await axios({\n          url: '/bff-center/showCommon/clothingInfoOperation/updateClothingInfo',\n          method: 'POST',\n          data: {\n            ...getEditableProperties(),\n          },\n        });\n        mode.value = IMode.view;\n      }\n      // emit('confirm', detailInfo.value);\n    }\n\n    const priceOptions = useLoader(async () => {\n      const res = (await axios({\n        url: '/bff-center/showCommon/getDictionaryTypeItem',\n        headers: {\n          language: 'cn',\n        },\n        params: {\n          typeCode: 'priceUnit',\n        },\n      })).data;\n      return res as DictItem[];\n    }, {}, {\n      initialValue: [],\n    });\n\n    return {\n      oldInfo,\n      detailForm,\n      mode,\n      selectOptions,\n      priceOptions,\n      detailInfo,\n      filteredMaterialInfo,\n      patternsInfo,\n\n      handleAfterEdit,\n    };\n  },\n});\nexport default cDetail;\n","import {\n  computed, defineComponent, ref, watch,\n} from '@vue/composition-api';\n\nconst numberType = defineComponent({\n  props: {\n    builder: {\n      type: String,\n      default: 'el-input',\n    },\n    val: {\n      type: [String, Number],\n      default: '',\n    },\n    toFixed: {\n      type: Number,\n      default: 2,\n    },\n    max: {\n      type: Number,\n      default: Infinity,\n    },\n    min: {\n      type: Number,\n      default: -Infinity,\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  model: {\n    prop: 'val',\n    event: 'change',\n  },\n  render() {\n    const s = this as InstanceType<typeof numberType>;\n    const { builder, disabled } = s;\n    return <builder value={s.parsedValue} oninput={s.handleUpdateValue}\n    disabled={ disabled }\n    onfocus={(e: Event) => s.$emit('focus', e)}\n    onblur={(e: Event) => s.$emit('blur', e)}/>;\n  },\n  setup(props, { emit }) {\n    const hasDot = computed(() => String(props.val).includes('.'));\n    const parsedValue = ref('');\n    watch(() => props.val, () => {\n      if (+props.val === 0 || globalThis.isNaN(+props.val)) parsedValue.value = '';\n      else parsedValue.value = String(props.val);\n    }, {\n      immediate: true,\n    });\n    function updateParsedValue(value: string) {\n      parsedValue.value = value;\n    }\n    function handleUpdateValue(newStr: string) {\n      // 禁止多个小数点，最多一位\n      if (newStr.indexOf('.') !== newStr.lastIndexOf('.')) return;\n      let leng;\n      let short;\n      if (newStr.length > parsedValue.value.length) {\n        leng = newStr;\n        short = parsedValue.value;\n      } else {\n        short = newStr;\n        leng = parsedValue.value;\n      }\n      // 有一个小数点时，这个小数点无论是新增的还是要删掉的都合法\n      if (leng[leng.length - 1] === '.') {\n        updateParsedValue(newStr);\n        return;\n      }\n\n      // 允许1.0 1.00 1.000\n      if (/\\.[0-9]?[0-9]?0$/.test(leng)) {\n        updateParsedValue(newStr);\n        return;\n      }\n\n      // 允许第一位是减号\n      if (leng.includes('-')) {\n        if (leng.lastIndexOf('-') !== 0) return;\n        if (short === '-' || leng === '-') {\n          updateParsedValue(newStr);\n          return;\n        }\n      }\n      // 限制小数位长度\n      if (hasDot.value && newStr.length - 1 - newStr.indexOf('.') > props.toFixed) return;\n      if (newStr && globalThis.isNaN(+newStr)) return;\n      // 验证成功，已是数字\n      if (+newStr > props.max) return;\n      if (+newStr < props.min) return;\n      // 验证成功，已是合法数字\n      emit('change', +newStr);\n      emit('input', +newStr);\n    }\n    return {\n      parsedValue,\n\n      handleUpdateValue,\n    };\n  },\n});\n\n\nexport default numberType;\n","var render, staticRenderFns\nimport script from \"./ClothesDetail.vue?vue&type=script&lang=tsx&\"\nexport * from \"./ClothesDetail.vue?vue&type=script&lang=tsx&\"\nimport style0 from \"./ClothesDetail.vue?vue&type=style&index=0&id=6597be48&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6597be48\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClothesDetail.vue?vue&type=script&lang=tsx&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClothesDetail.vue?vue&type=script&lang=tsx&\""],"sourceRoot":""}