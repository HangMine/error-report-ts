{"version":3,"sources":["webpack:///./src/components/dynamic-form/uploader/UploadAreaStyle1.tsx","webpack:///./src/components/dynamic-form/DemandOrderDetail.vue","webpack:///./src/components/dynamic-form/DemandOrderDetail.vue?2304","webpack:///./src/components/dynamic-form/DemandOrderDetail.vue?680a","webpack:///./src/components/dynamic-form/DemandOrderDetail.vue?b3df"],"names":["stopEvent","e","this","disable","preventDefault","stopPropagation","$act","Error","staticRenderFns","uploadStyle1","props","type","Boolean","default","render","s","width","height","border","borderRadius","padding","cursor","call","background","marginBottom","color","fontSize","i18n","t","systemFoldersTitle","demandOrderDetail","id","String","required","f","f2","singleUploaderGenerator","target","sample","attachment","find","item","files","backgroundColor","tip","hide","isUploading","marginRight","styleName","totalCount","totalSize","filter","isCustom","map","folder","fontWeight","name","index","borderBottom","length","paddingBottom","editId","marginTop","requirement","position","margin","bottom","textAlign","left","handleSave","saveButtonText","setup","root","$alert","window","opener","current","systemFolders","customFolders","value","title","push","each","i","$refs","filesSize","args","total","reduce","acc","cur","n","u","toFixed","detail","size","immediate","filesCount","count","localStorage","getItem","show","setItem","Object","keys","alert","close","newName","document","getTotalPercentage","res","wait4Upload","uploadPercentage","setStatus","timer","setInterval","percentage","Math","floor","setPercentage","Promise","all","uploadProcess","then","clearInterval","hasUpdated","catch","err","finally","component"],"mappings":"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","file":"js/chunk-60ad2092.50d30a31.js","sourcesContent":["import i18n from '@/i18n';\nimport { defineComponent } from '@vue/composition-api';\n\n// eslint-disable-next-line no-use-before-define\nfunction stopEvent(this: InstanceType<typeof uploadStyle1>, e: MouseEvent) {\n  if (this.disable) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.$act(() => {\n      throw new Error('上传不可用');\n    });\n  }\n}\n\nconst uploadStyle1 = defineComponent({\n  props: {\n    disable: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  render() {\n    const s = this as InstanceType<typeof uploadStyle1>;\n    return <div class=\"flex-column flex-center\" style={{\n      width: '116px',\n      height: '100px',\n      border: '1px dashed #bdc3cb',\n      borderRadius: '2px',\n      padding: '0 10px',\n      cursor: s.disable ? 'not-allowed' : true,\n    }} ondrop={(e:MouseEvent) => stopEvent.call(s, e)} onclick={(e:MouseEvent) => stopEvent.call(s, e)}>\n      <div class=\"flex-center\" style={{\n        width: '34px',\n        height: '34px',\n        borderRadius: '50%',\n        background: s.disable ? '#f7f7f7' : 'rgba(41, 131, 255, 0.1)',\n        marginBottom: '8px',\n      }}>\n        <i style={{ color: s.disable ? '#ddd' : '#2787ff' }} class=\"iconfont iconxiangshangjiantou\"></i>\n      </div>\n      <div style={{ color: '#606060', fontSize: '12px' }}>{i18n.t('order_management.attachments.upload_desc')}</div>\n    </div>;\n  },\n});\nexport default uploadStyle1;\n","var render, staticRenderFns\nimport script from \"./DemandOrderDetail.vue?vue&type=script&lang=tsx&\"\nexport * from \"./DemandOrderDetail.vue?vue&type=script&lang=tsx&\"\nimport style0 from \"./DemandOrderDetail.vue?vue&type=style&index=0&id=6b117e46&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b117e46\",\n  null\n  \n)\n\nexport default component.exports","\n\nimport {\n  defineComponent, onMounted, ref, watch, getCurrentInstance, Ref,\n} from '@vue/composition-api';\nimport splitUnit from '_/split-unit';\nimport i18next from '@/i18n';\nimport errHandler from '../../utils/error-handler';\nimport UploadArea from './uploader/UploadAreaStyle1';\nimport Uploader from './Uploader.vue';\nimport { Sample, SampleFolder, SampleDetail } from './OrderSamples.vue';\n\n\nconst systemFoldersTitle = [\n  i18next.t('order_management.attachments.design_sketch'),\n  i18next.t('order_management.attachments.shoe_last_file'),\n  i18next.t('order_management.attachments.material_file'),\n  i18next.t('order_management.attachments.sample_file'),\n  i18next.t('order_management.attachments.outsole'),\n  i18next.t('order_management.attachments.accessories_file'),\n  i18next.t('order_management.attachments.other'),\n];\n\nconst demandOrderDetail = defineComponent({\n  props: {\n    id: {\n      type: String,\n      required: true,\n    },\n    // 是否禁用上传\n    f: {\n      type: String,\n    },\n    // 是否禁用编辑要求\n    f2: {\n      type: String,\n    },\n  },\n  render() {\n    const s = this as InstanceType<typeof demandOrderDetail>;\n    const singleUploaderGenerator = (\n      id: string,\n    ) => {\n      const target = s.sample.attachment.find(item => item.id === id)!;\n      return <Uploader showDownloadAll={false} uploadedFiles={target.files} uploadImmediately={false}\n        class='flex upload-area' maxSize={500} disable={!!s.f}\n        ref={id}\n      >\n        <UploadArea disable={!!s.f} />\n      </Uploader>;\n    };\n    return (\n      <section style={{\n        backgroundColor: '#eff1f7',\n        width: '100%',\n        padding: '20px',\n      }} onclick={() => { s.tip!.hide(); }} ondrop={(e: Event) => {\n        e.preventDefault();\n        e.stopPropagation();\n      }} ondragover={(e: Event) => {\n        e.preventDefault();\n        e.stopPropagation();\n      }}>\n        <div class='container flex-column' vLoading={s.isUploading}>\n          <div style={{\n            marginBottom: '10px',\n          }} class='flex-space-between'>\n            <div class='flex-vertical-center'>\n              <h2 style={{ marginRight: '8px', fontSize: '18px' }}>{i18next.t('order_management.attachments.style')}-{s.sample?.styleName}</h2>\n\n              <el-tooltip ref='tip'\n                content={`${i18next.t('order_management.attachments.desc')}`}>\n                <i style={{\n                  // color: '#2878ff',\n                  fontSize: '20px',\n                }} class=\"iconfont iconhelp_nol icon-link-class\"></i>\n              </el-tooltip>\n            </div>\n\n            <div>\n              <span class='color-999' style={{ marginRight: '8px' }}>\n                <i18n path=\"order_management.attachments.file_number\">\n                  <span class='color-333' place=\"count\">&nbsp;{s.totalCount}</span>\n                </i18n>\n              </span>\n              {\n                //   {i18n.t('order_management.attachments.file_number')}&nbsp;\n                // <span class='color-333'>{s.totalCount}</span>\n                // &nbsp;个\n              }\n              <span class='color-999'>\n                <i18n path=\"order_management.attachments.file_size\">\n                  <span class='color-333' place=\"size\">&nbsp;{s.totalSize}</span>&nbsp;\n                </i18n>\n              </span>\n            </div>\n          </div>\n          {\n            s.sample.attachment.filter(f => !f.isCustom).map((folder) => <div key={folder.id}\n              class='single-uploader-container flex-column'>\n              <h3 style={{\n                marginBottom: '16px',\n                fontWeight: '400',\n              }}>{folder.name}</h3>\n\n              {\n                singleUploaderGenerator(folder.id)\n              }\n            </div>)\n          }\n          {\n            s.sample.attachment.filter(f => f.isCustom).map((folder, index) => <div key={folder.id}\n              class='single-uploader-container flex-column' style={{\n                borderBottom: s.sample.attachment.filter(f => f.isCustom).length - 1 === index ? 0 : true,\n                paddingBottom: s.sample.attachment.filter(f => f.isCustom).length - 1 === index ? 0 : true,\n              }}>\n\n\n              {\n                s.editId !== folder.id\n                  ? <div class=\"flex-vertical-center\">\n                    <h3 style={{\n                      marginBottom: '16px',\n                      fontWeight: '400',\n                    }}>{folder.name}</h3>\n\n                    <i style={{\n                      cursor: 'pointer',\n                      marginBottom: '15px',\n                    }} class=\"iconfont icon-rename\" onclick={() => {\n                      if (!s.f) {\n                        s.editId = folder.id;\n                      }\n                    }}></i>\n                  </div>\n                  : <div>\n                    <el-input style={{ width: '200px', marginBottom: '15px' }}\n                      size=\"mini\" vModel={folder.name}\n                      onblur={() => { s.editId = ''; }}></el-input>\n                  </div>\n              }\n\n              {\n\n                // <el-button onclick={async () => {\n                //   const value = await s.$injectDialog({\n                //     is: defineComponent({\n                //       render(h) {\n                //         const self = this;\n                //         return h('div', [\n                //           h('el-input', {\n                //             value: this.value,\n                //             on: {\n                //               input(v: string) { self.value = v; },\n                //             },\n                //           }),\n                //           h('el-button', {\n                //             onclick: this.$emit('confirm', self.value),\n                //           }),\n                //         ]);\n                //       },\n                //       setup() {\n                //         return {\n                //           value: ref(''),\n                //         };\n                //       },\n                //     }),\n                //   }) as string;\n                //   s.customFolders[0].name = value;\n                // }}>修改</el-button>\n              }\n\n\n              {\n                singleUploaderGenerator(folder.id)\n              }\n            </div>)\n          }\n        </div>\n\n        <div style={{\n          marginTop: '20px',\n          marginBottom: '92px',\n        }} class=\"container flex-column\">\n          <h2 style={{\n            marginBottom: '20px', fontSize: '18px',\n          }}>{i18next.t('order_management.attachments.sample_notes')}</h2>\n          <el-input disabled={!!s.f2}\n            vModel={s.sample.requirement} type='textarea' maxlength={500}\n            show-word-limit placeholder={i18next.t('order_management.attachments.sample_notes_placeholder')}\n            rows={5}></el-input>\n        </div>\n\n        <footer vShow={!s.f} class=\"container\" style={{\n          position: 'fixed',\n          margin: '0 auto',\n          bottom: '0',\n          textAlign: 'right',\n          left: 'calc(50vw - 603.5px)',\n        }}>\n          <el-button disabled={s.isUploading} style={{\n            padding: '9px 20px',\n            borderRadius: '20px',\n          }} type=\"primary\" onclick={() => s.handleSave()}>{s.saveButtonText}</el-button>\n        </footer>\n      </section>\n    );\n  },\n  setup(props, { root: { $alert } }) {\n    const sample = ref<Sample>(window.opener[`sample_${props.id}`]);\n    const totalSize = ref('0');\n    const totalCount = ref(0);\n    const current = getCurrentInstance()!;\n    // const customFolders = ref([{\n    //   name: '自定义',\n    //   edit: false,\n    // }]);\n    const systemFolders = ref<SampleFolder[]>([]);\n    const customFolders = ref<SampleFolder[]>([]);\n\n    if (sample.value.attachment.length) {\n      systemFolders.value = sample.value.attachment.filter(f => !f.isCustom);\n      customFolders.value = sample.value.attachment.filter(f => f.isCustom);\n      // sample.value.attachment.push(\n      //   ...systemFolders.map(folder => new SampleFolder(folder)),\n      //   ...customFolders.value.map(folder => new SampleFolder(folder.name, true)),\n      // );\n    } else {\n      systemFolders.value = systemFoldersTitle.map(title => new SampleFolder(title));\n      customFolders.value.push(new SampleFolder(i18next.t('order_management.attachments.customeize'), true));\n      sample.value.attachment.push(\n        ...systemFolders.value,\n        ...customFolders.value,\n      );\n    }\n\n    watch(() => {\n      return [...systemFolders.value.map((each, i) => (\n        (current.$refs[each.id] as InstanceType<typeof Uploader> || {})\n      ).filesSize || 0),\n      ...customFolders.value.map((each, i) => (\n        (current.$refs[each.id] as InstanceType<typeof Uploader> || {})\n      ).filesSize || 0),\n      ];\n    }, (args) => {\n      const total = args.reduce((acc, cur) => acc + cur);\n      const [n, u] = splitUnit(total);\n      if (!n || !u) {\n        totalSize.value = '0';\n        sample.value.detail.size = totalSize.value;\n      } else {\n        // totalSize.value = `${n.toFixed(2)}${u}`;\n        totalSize.value = `${n.toFixed(2)}`;\n        sample.value.detail.size = totalSize.value;\n      }\n    }, {\n      immediate: true,\n    });\n    watch(() => {\n      return [...systemFolders.value.map((each, i) => (\n        (current.$refs[each.id] as InstanceType<typeof Uploader> || {})\n      ).filesCount || 0),\n      ...customFolders.value.map((each, i) => (\n        (current.$refs[each.id] as InstanceType<typeof Uploader> || {})\n      ).filesCount || 0),\n      ];\n    }, (args) => {\n      totalCount.value = args.reduce((acc, cur) => acc + cur);\n      sample.value.detail.count = totalCount.value;\n    }, {\n      immediate: true,\n    });\n    type A = { show: () => void, hide: () => void };\n    const tip = ref<A>();\n    // eslint-disable-next-line prefer-arrow-callback\n    onMounted(() => {\n      if (!localStorage.getItem('order-detail-tip-show')) {\n        if (tip.value) {\n          tip.value.show();\n          localStorage.setItem('order-detail-tip-show', '1');\n        }\n      }\n    });\n    // setTimeout(() => window.close(), 2000);\n\n    if (!Object.keys(sample.value).length) {\n      alert('找不到对应上传页，本页面将关闭');\n      window.close();\n    }\n\n\n    watch(() => sample.value.styleName, newName => {\n      window.document.title = newName;\n    }, {\n      immediate: true,\n    });\n\n    const isUploading = ref(false);\n\n    const saveButtonText = ref(i18next.t('order_management.sample_dynamic_form.save'));\n\n    async function handleSave() {\n      isUploading.value = true;\n      SampleDetail.setStatus(sample.value.detail, 1);\n      function getTotalPercentage() {\n        const res = [\n          ...systemFolders.value.map((f, i) => {\n            const u = current.$refs[f.id] as InstanceType<typeof Uploader>;\n            if (u.wait4Upload!.length) return u.uploadPercentage;\n            return 0;\n          }),\n          ...customFolders.value.map((f, i) => {\n            const u = current.$refs[f.id] as InstanceType<typeof Uploader>;\n            if (u.wait4Upload!.length) return u.uploadPercentage;\n            return 0;\n          }),\n        ];\n        return res.reduce((acc, cur) => acc + cur) / (res.filter(i => i !== 0).length || 1);\n      }\n      const timer = setInterval(() => {\n        const percentage = Math.floor(getTotalPercentage()) || 100;\n        SampleDetail.setPercentage(sample.value.detail, percentage);\n      }, 200);\n      await Promise.all(\n        [\n          ...systemFolders.value.map((f, i) => (\n            current.$refs[f.id] as InstanceType<typeof Uploader>\n          ).uploadProcess()),\n          ...customFolders.value.map((f, i) => (\n            current.$refs[f.id] as InstanceType<typeof Uploader>\n          ).uploadProcess()),\n          // eslint-disable-next-line prefer-promise-reject-errors\n        ],\n      ).then(() => {\n        clearInterval(timer);\n        SampleDetail.setPercentage(sample.value.detail, 100);\n        SampleDetail.setStatus(sample.value.detail, 2);\n        saveButtonText.value = i18next.t('order_management.form_submit.save');\n        sample.value.hasUpdated = true;\n        window.close();\n      }).catch((err) => {\n        clearInterval(timer);\n        saveButtonText.value = i18next.t('order_management.form_submit.save_again');\n        SampleDetail.setStatus(sample.value.detail, 3);\n        errHandler(err);\n      }).finally(() => {\n        isUploading.value = false;\n      });\n    }\n\n    const editId = ref('');\n    return {\n      tip,\n      editId,\n      totalSize,\n      totalCount,\n      sample,\n      isUploading,\n      saveButtonText,\n\n      handleSave,\n    };\n  },\n});\nexport default demandOrderDetail;\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DemandOrderDetail.vue?vue&type=script&lang=tsx&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--14-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DemandOrderDetail.vue?vue&type=script&lang=tsx&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DemandOrderDetail.vue?vue&type=style&index=0&id=6b117e46&scoped=true&lang=scss&\""],"sourceRoot":""}