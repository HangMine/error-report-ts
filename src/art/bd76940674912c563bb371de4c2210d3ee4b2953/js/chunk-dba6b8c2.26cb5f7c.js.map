{"version":3,"sources":["webpack:///./src/assets/img/material/4ddat.png","webpack:///./src/api/material.js","webpack:///./src/views/upload/anta-material/components/Disclaimer.vue?a4f3","webpack:///./src/views/upload/anta-material/index.vue?7a53","webpack:///./src/views/upload/anta-material/index.vue","webpack:///./src/views/upload/anta-material/index.vue?156b","webpack:///./src/views/upload/anta-material/components/Disclaimer.vue","webpack:///src/views/upload/anta-material/components/Disclaimer.vue","webpack:///./src/views/upload/anta-material/components/Disclaimer.vue?3cca","webpack:///./src/views/upload/anta-material/index.vue?635f"],"names":["module","exports","uploadMaterialInfo","data","axios","method","url","headers","groupAppId","workspaceId","getMaterialInfo","materialId","language","params","fetchMaterialTypes","id","businessTypes","uploadAtanMaterial","staticRenderFns","AntaMaterialUpload","name","props","templateMaterialId","type","String","default","parentFolderId","requierd","setup","root","AntaFormRef","isloading","submit","closeWin","value","getFormData","material","uploadData","$message","success","window","close","$errorHandler","batchUpload","file","console","info","reader","FileReader","workbook","onload","e","Uint8Array","target","result","XLSX","read","utils","sheet_to_json","Sheets","readAsArrayBuffer","screenWidth","innerWidth","addEventListener","render","this","$router","push","path","query","$route","newMaterial","imgJson","width","$act","component","functional"],"mappings":"sHAAAA,EAAOC,QAAU,IAA0B,0B,gLCyB9BC,EAAqB,SAACC,GACjC,OAAOC,eAAM,CACXC,OAAQ,OACRC,IAAK,gCACLC,QAAS,CACPC,WAAYL,EAAKM,aAAe,IAElCN,UASSO,EAAkB,SAACC,EAAYC,EAAUJ,GACpD,OAAOJ,eAAM,CACXC,OAAQ,MACRC,IAAK,qDACLC,QAAS,CACPK,WACAJ,cAEFK,OAAQ,CAAEF,iBA8EDG,EAAkB,yDAAG,oHAAOC,EAAP,+BAAY,KAAMC,EAAlB,+BAAkC,EAC9Db,EAAO,KADqB,KAExBa,EAFwB,OAGzB,IAHyB,OAUzB,IAVyB,wCAIdZ,eAAM,CAClBC,OAAQ,MACRC,IAAK,yCAAF,OAA2CS,KANpB,cAI5BZ,EAJ4B,OAOxBA,KAPwB,8CAWdC,eAAM,CAClBC,OAAQ,MACRC,IAAK,gCAAF,OAAkCS,KAbX,eAW5BZ,EAX4B,OAcxBA,KAdwB,sDAmBzBA,GAnByB,4CAAH,sD,oCC/H/B,W,sbCSA,SAASc,EAAmBd,GAC1B,OAAO,OAAAC,EAAA,MAAM,CACXC,OAAQ,OACRC,IAAK,4CACLH,SAIJ,ICjBI,EAAQe,EDiBNC,EAAqB,6BAAgB,CACzCC,KAAM,qBACNC,MAAO,CACLC,mBAAoB,CAClBC,KAAMC,OACNC,QAAS,IAEXC,eAAgB,CACdH,KAAMC,OACNG,UAAU,GAEZlB,YAAa,CACXc,KAAMC,OACNG,UAAU,IAGdC,MAhByC,SAgBnCP,EAhBmC,GAgBpB,IAANQ,EAAM,EAANA,KACPC,EAAc,mBAEdC,EAAY,kBAAa,GAEzBC,EAAM,yDAAG,+HAAOC,IAAP,iCACbF,EAAUG,OAAQ,EADL,kBAGYJ,EAAYI,MAAOC,cAH/B,cAGLC,EAHK,OAIHV,EAAgCL,EAAhCK,eAAgBjB,EAAgBY,EAAhBZ,YAClB4B,EALK,iCAMND,GANM,IAOTV,iBACAjB,gBARS,UAWLQ,EAAmBoB,GAXd,WAYXR,EAAKS,SAASC,QAAQ,WAClBN,EAbO,kCAcH,IAAM,KAdH,QAeTO,OAAOC,QAfE,6DAkBXZ,EAAKa,cAAL,MAlBW,yBAoBXX,EAAUG,OAAQ,EApBP,6EAAH,qDAwBNS,EAAW,yDAAG,WAAOC,GAAP,yFAClBC,QAAQC,KAAKF,GACPG,EAAS,IAAIC,WACfC,EAAW,KACfF,EAAOG,OAAS,SAACC,GACf,IAAMhD,EAAO,IAAIiD,WAAWD,EAAEE,OAAOC,QACrCL,EAAWM,KAAKC,KAAKrD,EAAM,CAAEoB,KAAM,UAEnCsB,QAAQC,KAAKG,GACbJ,QAAQC,KAAKS,KAAKE,MAAMC,cAAcT,EAASU,OAAO,WAExDZ,EAAOa,kBAAkBhB,GAXP,2CAAH,sDAcXiB,EAAc,iBAAY,MAUhC,OARA,wBAAU,WACRA,EAAY3B,MAAQM,OAAOsB,WAAa,KAAO,KAAOtB,OAAOsB,WAE7DtB,OAAOuB,iBAAiB,UAAU,WAChCF,EAAY3B,MAAQM,OAAOsB,WAAa,KAAO,KAAOtB,OAAOsB,iBAI1D,CACLhC,cACAE,SACA6B,cACA9B,YACAY,gBAIJqB,OA9EyC,WA8EnC,4BAEF1C,EACE2C,KADF3C,mBAAoBuC,EAClBI,KADkBJ,YAAa9B,EAC/BkC,KAD+BlC,UAC/BkC,KAD0CjC,OAE9C,sBAAkB,0BAAlB,kCAAuDD,KAAvD,eACY,iBADZ,yBAEa,sBAFb,wBAGgB,mBAHhB,6FAK+B,eAL/B,UAKuD,WACnD,EAAKmC,QAAQC,KAAK,CAChBC,KAAM,8BACNC,MAAO,EAAKC,OAAOD,WARzB,cAUc,aAVd,SAYI,UAAAJ,KAAKnC,mBAAL,SAAkByC,YAAYC,QAA9B,eAAmD,iBAAnD,qBACY,EAAQ,QADpB,MAC8D,UACrD,KAdb,sBAiBU,gBAjBV,IAkBQ,cAlBR,0BAmBwBlD,EAnBxB,OAoBW,YApBX,mBAuBiB,oEAvBjB,MAwBW,CAAEmD,MAAO,GAAF,OAAKZ,EAAL,QAxBlB,0BA2Be,uBA3Bf,2CA8BiB,kBAAM,EAAKa,KAAK,SAAU,EAAC,OA9B5C,qDAiCiB,kBAAMlC,OAAOC,WAjC9B,4CAoCa,WApCb,UAqCiB,kBAAM,EAAKiC,KAAK,aArCjC,iBA4CW,IE/IsZ,I,wBDQjaC,EAAY,eACd,EACA,EACAzD,GACA,EACA,KACA,KACA,MAIa,aAAAyD,E,iDEnBX,EAAQzD,E,YCIZ,GACE0D,YAAY,EACZZ,OAFF,WAEA,mBACI,OAAO,EAAX,2BACA,MADA,QACA,QADA,QAEA,iDAFA,eAGA,YAHA,MAGA,qBAHA,cAIA,kCAJA,UAMA,+CCbiY,I,wBFQ7XW,EAAY,eACd,EACA,EACAzD,GACA,EACA,KACA,WACA,MAIa,OAAAyD,E,kEGnBf","file":"js/chunk-dba6b8c2.26cb5f7c.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/4ddat.c3413ecd.png\";","import axios from './axios';\n\n/**\n * 上传材质信息(deprecated)\n * @param {Object} data 模型信息对象（具体数据结构看API接口文档）\n * @param {String} groupAppId workspaceId,默认为空\n * @returns {Promise}\n */\nexport const uploadMaterial = (data, groupAppId = '') => {\n  return axios({\n    method: 'post',\n    url: '/show/material/upload',\n    headers: {\n      groupAppId,\n    },\n    data,\n  });\n};\n\n/**\n * 上传材质信息\n * @param {Object} data 模型信息对象（具体数据结构看API接口文档）\n * @param {String} groupAppId workspaceId,默认为空\n * @see http://yapi.4dshoetech.local/project/115/interface/api/6110\n */\nexport const uploadMaterialInfo = (data) => {\n  return axios({\n    method: 'post',\n    url: '/bff-center/showCommon/upload',\n    headers: {\n      groupAppId: data.workspaceId || '',\n    },\n    data,\n  });\n};\n\n/**\n * 获取材质详情信息\n * @param {String} materialId 材质Id\n * @see http://yapi.4dshoetech.local/project/115/interface/api/6026\n */\nexport const getMaterialInfo = (materialId, language, groupAppId) => {\n  return axios({\n    method: 'get',\n    url: '/bff-center/showCommon/getMaterialBasicInfoAndTags',\n    headers: {\n      language,\n      groupAppId,\n    },\n    params: { materialId },\n  });\n};\n\n/**\n * 获取材质详情信息，用于拖拽到鞋模型渲染时使用(deprecated)\n * @param {String} relateId 材质Id\n * @returns {Promise}\n */\nexport const getMaterialInfoForDrag = (relateId) => {\n  return axios({\n    method: 'get',\n    url: '/catalogue/appInteraction/getMaterialDetailInfo',\n    params: {\n      relateId,\n    },\n  });\n};\n\n/**\n * 更新材质详情信息（标签更新在其他接口）\n * @param {String} data { id: string, propName: any }\n * @see {Promise}\n */\nexport const updateMaterialInfo = (data) => {\n  return axios({\n    method: 'post',\n    url: '/bff-center/showCommon/updateNewMaterialInfo',\n    data,\n  });\n};\n\n/* ============================ 材质标签相关 ======================= */\n/**\n * 新增材质标签\n * @param {String} id 材质ID\n * @param {Array} tags 新添加的标签数组\n * @param {String} groupAppId workspaceId,默认为空\n * @returns {Promise}\n */\nexport const createNewTagForMaterial = (id, tags, groupAppId = '') => {\n  return axios({\n    method: 'post',\n    url: '/show/tag/addMaterialTag',\n    headers: {\n      groupAppId,\n    },\n    data: {\n      id,\n      tags,\n    },\n  });\n};\n\n/**\n * 删除材质标签\n * @param {String} id 材质ID\n * @param {Array} tags 新添加的标签数组\n * @param {String} groupAppId workspaceId,默认为空\n * @returns {Promise}\n */\nexport const deleteTagsOfMaterial = (id, tags, groupAppId = '') => {\n  return axios({\n    method: 'post',\n    url: '/show/tag/deleteMaterialTag',\n    headers: {\n      groupAppId,\n    },\n    data: {\n      id,\n      tags,\n    },\n  });\n};\n\n// ==============================================================\n\n// 查询类目列表(无分页)\nexport const fetchMaterialTypes = async (id = '-1', businessTypes = 1) => {\n  let data = null;\n  switch (businessTypes) {\n    case 1: {\n      data = (await axios({\n        method: 'get',\n        url: `/anta-material/category/list?parentId=${id}`,\n      })).data;\n      break;\n    }\n    case 0: {\n      data = (await axios({\n        method: 'get',\n        url: `/show/category/list?parentId=${id}`,\n      })).data;\n      break;\n    }\n    default:\n  }\n  return data;\n};\n","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Disclaimer.vue?vue&type=style&index=0&id=2baf8cb4&lang=scss&scoped=true&\"","\nimport { defineComponent, onMounted, ref } from '@vue/composition-api';\nimport axios from '@/utils/axios';\n\nimport AntaMaterialForm from '@/views/material/info-anta/components/Form.vue';\n// import FormSubmitButtons from '@/components/form/FormSubmitButtons.vue';\nimport delay from '_/delay';\nimport DiclaimerButton from './components/Disclaimer.vue';\n\nfunction uploadAtanMaterial(data: any) {\n  return axios({\n    method: 'POST',\n    url: '/anta-material/material/management/upload',\n    data,\n  });\n}\n\nconst AntaMaterialUpload = defineComponent({\n  name: 'AntaMaterialUpload',\n  props: {\n    templateMaterialId: {\n      type: String,\n      default: '',\n    },\n    parentFolderId: {\n      type: String,\n      requierd: true,\n    },\n    workspaceId: {\n      type: String,\n      requierd: true,\n    },\n  },\n  setup(props, { root }) {\n    const AntaFormRef = ref<InstanceType<typeof AntaMaterialForm>>();\n\n    const isloading = ref<boolean>(false);\n\n    const submit = async (closeWin = true) => {\n      isloading.value = true;\n      try {\n        const material = await AntaFormRef.value!.getFormData();\n        const { parentFolderId, workspaceId } = props;\n        const uploadData = {\n          ...material,\n          parentFolderId,\n          workspaceId,\n        };\n\n        await uploadAtanMaterial(uploadData);\n        root.$message.success('面料上传成功');\n        if (closeWin) {\n          await delay(2000);\n          window.close();\n        }\n      } catch (e) {\n        root.$errorHandler(e);\n      } finally {\n        isloading.value = false;\n      }\n    };\n\n    const batchUpload = async (file) => {\n      console.info(file);\n      const reader = new FileReader();\n      let workbook = null;\n      reader.onload = (e) => {\n        const data = new Uint8Array(e.target.result);\n        workbook = XLSX.read(data, { type: 'array' });\n\n        console.info(workbook);\n        console.info(XLSX.utils.sheet_to_json(workbook.Sheets['上传表单']));\n      };\n      reader.readAsArrayBuffer(file);\n    };\n\n    const screenWidth = ref<number>(1200);\n\n    onMounted(() => {\n      screenWidth.value = window.innerWidth > 1200 ? 1200 : window.innerWidth;\n\n      window.addEventListener('resize', () => {\n        screenWidth.value = window.innerWidth > 1200 ? 1200 : window.innerWidth;\n      });\n    });\n\n    return {\n      AntaFormRef,\n      submit,\n      screenWidth,\n      isloading,\n      batchUpload,\n    };\n  },\n\n  render() {\n    const {\n      templateMaterialId, screenWidth, isloading, submit,\n    } = this;\n    return <div class=\"material-upload-wrapper\" v-loading={isloading}>\n      <h3 style=\"padding: 20px\">上传面料</h3>\n      <div style=\"padding-left: 20px\">单个上传\n        <span style=\"font-size: 12px\">（ * web端不支持上传4ddat文件，可在pc端补充上传4ddat文件）</span>\n      </div>\n      <el-button plain round class=\"upload-batch\" onclick={() => {\n        this.$router.push({\n          path: '/upload/anta-material/batch',\n          query: this.$route.query,\n        });\n      }}><i class=\"i-upload\"></i>批量上传</el-button>\n      {\n        this.AntaFormRef?.newMaterial.imgJson ? <div style=\"padding: 20px\">\n          <img src={require('@/assets/img/material/4ddat.png')} width=\"50\" />\n        </div> : null\n      }\n      <AntaMaterialForm\n        style=\"padding: 20px\"\n        ref=\"AntaFormRef\"\n        templateMaterialId={templateMaterialId}\n        status=\"upload\"\n      >\n      </AntaMaterialForm>\n      <section class=\"material-upload-section flex-space-between material-upload-footer\"\n        style={{ width: `${screenWidth}px` }}\n      >\n        <DiclaimerButton />\n        <div class=\"form-submit-buttons\">\n          <el-button\n            round\n            onclick={() => this.$act('submit', [false])}>保存并复制</el-button>\n          <el-button\n            round\n            onclick={() => window.close()}>取消</el-button>\n          <el-button\n            round\n            type=\"primary\"\n            onclick={() => this.$act('submit')}>提交</el-button>\n        </div>\n      </section>\n    </div>;\n  },\n});\n\nexport default AntaMaterialUpload;\n","var render, staticRenderFns\nimport script from \"./index.vue?vue&type=script&lang=tsx&\"\nexport * from \"./index.vue?vue&type=script&lang=tsx&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=tsx&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--14-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=tsx&\"","var render, staticRenderFns\nimport script from \"./Disclaimer.vue?vue&type=script&lang=js&\"\nexport * from \"./Disclaimer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Disclaimer.vue?vue&type=style&index=0&id=2baf8cb4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2baf8cb4\",\n  null\n  \n)\n\nexport default component.exports","\n<script>\nimport i18n from 'i18next';\n\nexport default {\n  functional: true,\n  render() {\n    return (\n      <el-popover width=\"600\" trigger=\"hover\"\n      content={i18n.t('material.upload.disclaimer_content')}>\n        <div slot=\"reference\" class=\"disclaimer-button\">\n          <i class=\"iconfont iconmianzeshengming1\" />\n          <span>\n            { i18n.t('material.upload.disclaimer') }\n          </span>\n        </div>\n      </el-popover>\n    );\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.disclaimer-desc {\n  padding: 10px 15px;\n  font-size: 14px;\n  line-height: 24px;\n  word-break: break-word;\n}\n\n.disclaimer-button {\n  display: flex;\n  align-items: center;\n  height: 28px;\n  padding: 0 18px 0 6px;\n  font-size: 12px;\n  font-weight: 400;\n  border: 1px solid #ddd;\n  border-radius: 14px;\n  cursor: pointer;\n  transition: all linear 150ms;\n  &:hover {\n    border-color: transparent;\n    box-shadow: 0px 0px 8px 0px rgba(136, 149, 172, 0.3);\n  }\n\n  > .iconfont {\n    margin-right: 3px;\n    font-size: 18px;\n    color: #f2b334;\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Disclaimer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Disclaimer.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}